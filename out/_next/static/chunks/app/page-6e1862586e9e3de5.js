(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3129:function(e,s,t){Promise.resolve().then(t.bind(t,8303))},8303:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return T}});var r=t(7437),a=t(2265),l=t(5978),n=t(813),i=t(7763),c=t(1344),o=t(7293),d=t(6362);function x(e){let{selectedClientId:s,onClientSelect:t,showDropdown:n,onToggleDropdown:i}=e,[c,x]=(0,a.useState)([]),[m,u]=(0,a.useState)(!0),[h,p]=(0,a.useState)(""),{user:g}=(0,d.a)();(0,a.useEffect)(()=>{if(!(null==g?void 0:g.uid)){u(!0);return}let e=(0,l.IO)((0,l.hJ)(o.db,"clients"),(0,l.ar)("userId","==",g.uid));return(0,l.cf)(e,e=>{let s=e.docs.map(e=>({id:e.id,...e.data()}));s.sort((e,s)=>e.name.localeCompare(s.name)),x(s),u(!1)},e=>{console.error("❌ Error loading clients:",e),u(!1)})},[g]);let y=c.find(e=>e.id===s),f=c.filter(e=>!h||e.name.toLowerCase().includes(h.toLowerCase())||e.email.toLowerCase().includes(h.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(h.toLowerCase()))),b=e=>{t(e),i(),p("")},j=e=>{switch(e){case"Hot Lead":return"bg-red-900/30 text-red-300 border-red-700/50";case"Active":return"bg-green-900/30 text-green-300 border-green-700/50";default:return"bg-gray-700/50 text-gray-400 border-gray-600/50"}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Client (Optional)"}),(0,r.jsxs)("button",{type:"button",onClick:i,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex-1",children:y?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-white",children:y.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{children:y.email}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs ".concat(j(y.status)),children:y.status})]}),y.tags.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[y.tags.slice(0,2).map((e,s)=>(0,r.jsx)("span",{className:"px-1.5 py-0.5 bg-purple-900/20 text-purple-400 rounded text-xs",children:e},s)),y.tags.length>2&&(0,r.jsxs)("span",{className:"px-1.5 py-0.5 bg-gray-700 text-gray-400 rounded text-xs",children:["+",y.tags.length-2]})]})]}):(0,r.jsx)("span",{className:"text-gray-400",children:"Select an existing client or create new..."})}),(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-".concat(n?"up":"down","-s-line text-gray-400")})})]}),n&&(0,r.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",children:[(0,r.jsx)("div",{className:"p-3 border-b border-gray-700",children:(0,r.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Search clients...",className:"w-full px-3 py-2 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),(0,r.jsx)("div",{className:"max-h-48 overflow-y-auto",children:m?(0,r.jsx)("div",{className:"px-4 py-3 text-gray-400 text-sm",children:"Loading clients..."}):0===f.length?(0,r.jsx)("div",{className:"px-4 py-3 text-gray-400 text-sm",children:h?"No matching clients found":"No clients found. Create clients first."}):(0,r.jsx)(r.Fragment,{children:f.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>b(e),className:"w-full px-4 py-3 text-left hover:bg-gray-700 transition-colors text-sm cursor-pointer border-b border-gray-700 last:border-b-0 ".concat(s===e.id?"bg-blue-900/30":""),children:[(0,r.jsx)("div",{className:"text-white",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{children:e.email}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs ".concat(j(e.status)),children:e.status})]}),e.tags.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,s)=>(0,r.jsx)("span",{className:"px-1.5 py-0.5 bg-purple-900/20 text-purple-400 rounded text-xs",children:e},s)),e.tags.length>2&&(0,r.jsxs)("span",{className:"px-1.5 py-0.5 bg-gray-700 text-gray-400 rounded text-xs",children:["+",e.tags.length-2]})]})]},e.id))})}),y&&(0,r.jsx)("div",{className:"p-3 border-t border-gray-700",children:(0,r.jsx)("button",{type:"button",onClick:()=>{t(null),i(),p("")},className:"w-full px-3 py-2 text-red-400 hover:text-red-300 text-sm transition-colors cursor-pointer",children:"Clear Selection"})})]})]})}let m=["In-Person","Virtual","Open House","Follow-up Call"];function u(e){var s;let{onSubmit:t,loading:n}=e,[i,c]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[y,f]=(0,a.useState)(""),[b,j]=(0,a.useState)(""),[N,v]=(0,a.useState)([]),[w,S]=(0,a.useState)(!1),[C,T]=(0,a.useState)(""),[E,k]=(0,a.useState)("In-Person"),[D,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(""),[F,P]=(0,a.useState)(""),[O,U]=(0,a.useState)(!1),{user:L}=(0,d.a)();(0,a.useEffect)(()=>{if(!L)return;let e=(0,l.IO)((0,l.hJ)(o.db,"properties"),(0,l.ar)("userId","==",L.uid));return(0,l.cf)(e,e=>{v(e.docs.map(e=>({id:e.id,address:e.data().address,propertyType:e.data().propertyType||"Single Family",price:e.data().price||0,bedrooms:e.data().bedrooms||0,bathrooms:e.data().bathrooms||0,sqft:e.data().sqft||0,lotSize:e.data().lotSize,yearBuilt:e.data().yearBuilt,parking:e.data().parking,propertyFeatures:e.data().propertyFeatures||[],status:e.data().status||"Active",images:e.data().images||[]})))})},[L]);let M=async e=>{if(e.preventDefault(),i.trim()&&u.trim()&&b&&D){let e=N.find(e=>e.id===b);if(e){let s=y.split(",").map(e=>e.trim()).filter(e=>e.length>0),r={address:e.address,propertyType:e.propertyType||"Single Family",price:e.price||0,bedrooms:e.bedrooms||0,bathrooms:e.bathrooms||0,sqft:e.sqft||0,lotSize:e.lotSize,yearBuilt:e.yearBuilt,parking:e.parking,propertyFeatures:e.propertyFeatures||[],status:e.status||"Active",images:e.images||[]};if(console.log("\uD83C\uDFE0 ENHANCED PROPERTY CONTEXT FOR AI:",r),null==L?void 0:L.uid)try{let a={client:{name:i.trim(),email:u.trim(),phone:p.trim()},propertyId:e.id,propertyAddress:e.address,tags:s,notes:C.trim()||null,sessionType:E,consentGiven:D,scheduledAt:A?new Date(A):null,createdAt:(0,l.Bt)(),userId:L.uid,status:"initialized"};console.log("Client data being saved:",a);let n=await (0,l.ET)((0,l.hJ)(o.db,"sessions"),a);console.log("✅ Session saved to Firestore:",n.id),t({clientName:i.trim(),clientEmail:u.trim(),clientPhone:p.trim(),tags:s,propertyAddress:e.address,propertyId:e.id,propertyContext:r,agentNotes:C.trim()||void 0,sessionType:E,consentGiven:D,scheduledAt:A?new Date(A):void 0,selectedClientId:F||void 0})}catch(e){console.error("❌ Error saving session:",e),alert("Failed to save session data. Please try again.")}}}},B=e=>{j(e.id),S(!1)},z=N.find(e=>e.id===b),q=i.trim()&&u.trim()&&b&&D;return(0,r.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-lg p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center mt-0.5",children:(0,r.jsx)("i",{className:"ri-mic-line text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-blue-300 text-sm font-medium mb-1",children:"\uD83C\uDF99️ For best results:"}),(0,r.jsx)("p",{className:"text-blue-200 text-sm",children:"Ensure your microphone is clear and background noise is minimal."})]})]})}),(0,r.jsx)(x,{selectedClientId:F,onClientSelect:e=>{e?(P(e.id),c(e.name),h(e.email),g(e.phone||""),f(e.tags.join(", "))):(P(""),c(""),h(""),g(""),f(""))},showDropdown:O,onToggleDropdown:()=>U(!O)}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"clientName",className:"block text-sm font-medium text-gray-300 mb-2",children:"Client Name *"}),(0,r.jsx)("input",{type:"text",id:"clientName",value:i,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter client name",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"clientEmail",className:"block text-sm font-medium text-gray-300 mb-2",children:"Client Email *"}),(0,r.jsx)("input",{type:"email",id:"clientEmail",value:u,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"client@example.com",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"clientPhone",className:"block text-sm font-medium text-gray-300 mb-2",children:"Client Phone"}),(0,r.jsx)("input",{type:"tel",id:"clientPhone",value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"+1 (555) 123-4567"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-300 mb-2",children:["Tags",(0,r.jsx)("span",{className:"text-gray-500 text-xs ml-2",children:"(comma-separated)"})]}),(0,r.jsx)("input",{type:"text",id:"tags",value:y,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"first-time buyer, budget-conscious, family"}),y&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:y.split(",").map(e=>e.trim()).filter(e=>e.length>0).map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs",children:e},s))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"agentNotes",className:"block text-sm font-medium text-gray-300 mb-2",children:"Agent Notes (Optional)"}),(0,r.jsx)("textarea",{id:"agentNotes",value:C,onChange:e=>T(e.target.value.slice(0,1e3)),rows:3,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm resize-none",placeholder:"Include any special instructions or client context to improve the AI analysis...",maxLength:1e3}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Special instructions or context for better AI analysis"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[C.length,"/1000"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"sessionType",className:"block text-sm font-medium text-gray-300 mb-2",children:"Session Type"}),(0,r.jsx)("select",{id:"sessionType",value:E,onChange:e=>k(e.target.value),className:"w-full px-4 py-3 pr-8 border border-gray-700 rounded-lg bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:m.map(e=>(0,r.jsx)("option",{value:e,className:"bg-gray-800",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"scheduledAt",className:"block text-sm font-medium text-gray-300 mb-2",children:"Session Date (Optional)"}),(0,r.jsx)("input",{type:"datetime-local",id:"scheduledAt",value:A,onChange:e=>I(e.target.value),className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty if recording right now"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Property Address *"}),(0,r.jsxs)("button",{type:"button",onClick:()=>S(!w),className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex-1",children:z?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-white",children:z.address}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{children:z.propertyType}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("span",{children:["$",null===(s=z.price)||void 0===s?void 0:s.toLocaleString()]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs ".concat("Active"===z.status?"bg-green-900/30 text-green-300":"Coming Soon"===z.status?"bg-yellow-900/30 text-yellow-300":"bg-red-900/30 text-red-300"),children:z.status})]}),z.propertyFeatures&&z.propertyFeatures.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[z.propertyFeatures.slice(0,3).map((e,s)=>(0,r.jsx)("span",{className:"px-1.5 py-0.5 bg-blue-900/20 text-blue-400 rounded text-xs",children:e},s)),z.propertyFeatures.length>3&&(0,r.jsxs)("span",{className:"px-1.5 py-0.5 bg-gray-700 text-gray-400 rounded text-xs",children:["+",z.propertyFeatures.length-3]})]})]}):(0,r.jsx)("span",{className:"text-gray-400",children:"Select a property..."})}),(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-".concat(w?"up":"down","-s-line text-gray-400")})})]}),w&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",children:0===N.length?(0,r.jsx)("div",{className:"px-4 py-3 text-gray-400 text-sm",children:"No properties found. Add properties first."}):N.map(e=>{var s;return(0,r.jsxs)("button",{type:"button",onClick:()=>B(e),className:"w-full px-4 py-3 text-left hover:bg-gray-700 transition-colors text-sm cursor-pointer border-b border-gray-700 last:border-b-0",children:[(0,r.jsx)("div",{className:"text-white",children:e.address}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{children:e.propertyType}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("span",{children:["$",null===(s=e.price)||void 0===s?void 0:s.toLocaleString()]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs ".concat("Active"===e.status?"bg-green-900/30 text-green-300":"Coming Soon"===e.status?"bg-yellow-900/30 text-yellow-300":"bg-red-900/30 text-red-300"),children:e.status})]}),e.propertyFeatures&&e.propertyFeatures.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.propertyFeatures.slice(0,2).map((e,s)=>(0,r.jsx)("span",{className:"px-1.5 py-0.5 bg-blue-900/20 text-blue-400 rounded text-xs",children:e},s)),e.propertyFeatures.length>2&&(0,r.jsxs)("span",{className:"px-1.5 py-0.5 bg-gray-700 text-gray-400 rounded text-xs",children:["+",e.propertyFeatures.length-2]})]})]},e.id)})})]}),(0,r.jsx)("div",{className:"bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"consentGiven",checked:D,onChange:e=>R(e.target.checked),className:"mt-1 w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500 focus:ring-2",required:!0}),(0,r.jsxs)("label",{htmlFor:"consentGiven",className:"text-sm text-yellow-200",children:[(0,r.jsx)("span",{className:"font-medium",children:"✅ I have received consent from the client to record this session."}),(0,r.jsx)("p",{className:"text-xs text-yellow-300 mt-1",children:"Required before starting any recording session"})]})]})}),(0,r.jsx)("button",{type:"submit",disabled:n||!q,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:opacity-50 text-white font-medium rounded-lg transition-colors cursor-pointer whitespace-nowrap flex items-center justify-center space-x-2",children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,r.jsx)("span",{children:"Processing..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mic-line"})}),(0,r.jsx)("span",{children:"Start Recording"})]})}),!D&&(0,r.jsx)("p",{className:"text-xs text-red-400 text-center",children:"Please confirm you have client consent before proceeding"})]})}let h=()=>{let[e,s]=(0,a.useState)(!1),[t,r]=(0,a.useState)(0),[l,n]=(0,a.useState)(null),i=(0,a.useRef)(null),c=(0,a.useRef)(null),o=(0,a.useRef)(null);return{isRecording:e,recordingTime:t,audioBlob:l,startRecording:async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});c.current=e;let t=new MediaRecorder(e);i.current=t;let a=[];t.ondataavailable=e=>{a.push(e.data)},t.onstop=()=>{let e=new Blob(a,{type:"audio/wav"});n(e)},t.start(),s(!0),r(0),o.current=setInterval(()=>{r(e=>e+1)},1e3)}catch(e){throw console.error("Error starting recording:",e),e}},stopRecording:()=>{i.current&&i.current.stop(),c.current&&c.current.getTracks().forEach(e=>e.stop()),o.current&&clearInterval(o.current),s(!1)},resetRecording:()=>{n(null),r(0)},formatTime:e=>"".concat(Math.floor(e/60).toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))}};function p(e){let{onRecordingComplete:s}=e,{isRecording:t,recordingTime:a,audioBlob:l,startRecording:n,stopRecording:i,resetRecording:c,formatTime:o}=h(),d=async()=>{try{await n()}catch(e){console.error("Failed to start recording:",e)}};return(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,r.jsx)("div",{className:"text-4xl font-mono text-blue-500",children:o(a)}),!t&&!l&&(0,r.jsx)("button",{onClick:d,className:"w-20 h-20 bg-red-600 hover:bg-red-700 rounded-full flex items-center justify-center transition-colors cursor-pointer whitespace-nowrap",children:(0,r.jsx)("div",{className:"w-8 h-8 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mic-line text-3xl text-white"})})}),t&&(0,r.jsx)("button",{onClick:()=>{i()},className:"w-20 h-20 bg-gray-600 hover:bg-gray-700 rounded-full flex items-center justify-center transition-colors cursor-pointer whitespace-nowrap",children:(0,r.jsx)("div",{className:"w-8 h-8 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-stop-line text-3xl text-white"})})}),l&&!t&&(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:()=>{c()},className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-delete-bin-line"})}),(0,r.jsx)("span",{children:"Discard"})]})}),(0,r.jsx)("button",{onClick:()=>{l&&(s(l,a),c())},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-save-line"})}),(0,r.jsx)("span",{children:"Process"})]})})]})]})}function g(e){let{transcript:s,loading:t,transcriptSegments:l=[],sentimentMap:n=[],keywordAnalysis:i=[],speakers:c=[],overallSentiment:o="neutral"}=e,[d,x]=(0,a.useState)("transcript"),[m,u]=(0,a.useState)(l.length>0);if(t)return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Analyzing conversation..."})]}),(0,r.jsx)("p",{className:"text-gray-400",children:"Transcribing audio, identifying speakers, and analyzing sentiment"})]});let h=e=>{switch(e){case"positive":return"text-green-400 bg-green-900/20 border-green-700/50";case"negative":return"text-red-400 bg-red-900/20 border-red-700/50";default:return"text-gray-400 bg-gray-900/20 border-gray-700/50"}},p=e=>{switch(e){case"Agent":return"text-blue-400 bg-blue-900/30";case"Client":return"text-purple-400 bg-purple-900/30";case"Client2":return"text-green-400 bg-green-900/30";default:return"text-gray-400 bg-gray-900/30"}},g=e=>{switch(e){case"property":return"text-blue-400 bg-blue-900/30";case"price":return"text-yellow-400 bg-yellow-900/30";case"concern":case"negative":return"text-red-400 bg-red-900/30";case"positive":return"text-green-400 bg-green-900/30";default:return"text-gray-400 bg-gray-900/30"}},y=(e,s)=>{if(0===s.length)return e;let t=e;return s.slice(0,10).forEach(e=>{let s=RegExp("\\b".concat(e.word,"\\b"),"gi");t=t.replace(s,'<mark class="bg-yellow-900/40 text-yellow-200 px-1 rounded">'.concat(e.word,"</mark>"))}),t};return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-file-text-line text-blue-500"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Conversation Analysis"})]}),(0,r.jsx)("div",{className:"px-3 py-1 rounded-full border text-xs font-medium ".concat(h(o)),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("positive"===o?"emotion-happy":"negative"===o?"emotion-sad":"emotion-normal","-line")})}),(0,r.jsxs)("span",{className:"capitalize",children:[o," Tone"]})]})})]}),(0,r.jsxs)("div",{className:"flex border-b border-gray-700",children:[(0,r.jsx)("button",{onClick:()=>x("transcript"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("transcript"===d?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Transcript"}),(0,r.jsx)("button",{onClick:()=>x("analysis"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("analysis"===d?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Sentiment"}),(0,r.jsx)("button",{onClick:()=>x("keywords"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("keywords"===d?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Keywords"})]}),(0,r.jsxs)("div",{className:"p-4",children:["transcript"===d&&(0,r.jsxs)("div",{className:"space-y-4",children:[l.length>0&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Show speakers:"}),(0,r.jsx)("button",{onClick:()=>u(!m),className:"px-3 py-1 rounded-lg text-xs transition-colors cursor-pointer whitespace-nowrap ".concat(m?"bg-blue-600 text-white":"bg-gray-700 text-gray-300"),children:m?"On":"Off"})]}),m&&c.length>1&&(0,r.jsx)("div",{className:"flex items-center space-x-2",children:c.map((e,s)=>(0,r.jsx)("div",{className:"px-2 py-1 rounded-full text-xs ".concat(p(e)),children:e},s))})]}),(0,r.jsx)("div",{className:"bg-gray-900 rounded-lg p-4 max-h-80 overflow-y-auto",children:m&&l.length>0?(0,r.jsx)("div",{className:"space-y-3",children:l.map((e,s)=>(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("div",{className:"px-2 py-1 rounded text-xs font-medium flex-shrink-0 ".concat(p(e.speaker)),children:e.speaker}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:y(e.text,i)}}),(0,r.jsx)("div",{className:"inline-block mt-1 px-2 py-0.5 rounded-full text-xs ".concat(h(e.sentiment)),children:e.sentiment})]})]},s))}):(0,r.jsx)("p",{className:"text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:y(s,i)}})})]}),"analysis"===d&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-3 gap-4",children:["positive","neutral","negative"].map(e=>{let s=n.filter(s=>s.sentiment===e).length,t=n.length>0?Math.round(s/n.length*100):0;return(0,r.jsx)("div",{className:"p-3 rounded-lg border ".concat(h(e)),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-lg font-bold",children:[t,"%"]}),(0,r.jsx)("div",{className:"text-xs capitalize",children:e}),(0,r.jsxs)("div",{className:"text-xs opacity-75",children:["(",s," segments)"]})]})},e)})}),n.length>0&&(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 max-h-64 overflow-y-auto",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Sentence-level Analysis"}),(0,r.jsx)("div",{className:"space-y-2",children:n.slice(0,10).map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"px-2 py-1 rounded text-xs ".concat(h(e.sentiment)),children:e.sentiment}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-gray-300 text-sm",children:e.sentence}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Confidence: ",Math.round(100*e.confidence),"%"]})]})]},s))})]})]}),"keywords"===d&&(0,r.jsx)("div",{className:"space-y-4",children:i.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Top Discussion Topics"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.sort((e,s)=>s.relevance*s.frequency-e.relevance*e.frequency).slice(0,s)})(i).map((e,s)=>(0,r.jsxs)("div",{className:"px-3 py-2 rounded-lg border ".concat(g(e.category)),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium",children:e.word}),(0,r.jsxs)("span",{className:"text-xs opacity-75",children:["\xd7",e.frequency]})]}),(0,r.jsx)("div",{className:"text-xs opacity-75 capitalize",children:e.category||"general"})]},s))})]}),(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 max-h-64 overflow-y-auto",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Detailed Keyword Analysis"}),(0,r.jsx)("div",{className:"space-y-3",children:i.slice(0,15).map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("span",{className:"text-white font-medium",children:e.word}),(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(g(e.category)),children:e.category||"general"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-400",children:[(0,r.jsxs)("span",{children:["\xd7",e.frequency]}),(0,r.jsx)("div",{className:"w-16 bg-gray-700 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(100*e.relevance,"%")}})})]})]},s))})]})]}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-search-line text-4xl text-gray-600"})}),(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"No Keywords Identified"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Keyword analysis will appear here after processing"})]})})]})]})}var y=t(4432);function f(e){let{isOpen:s,onClose:t,recordingId:l,userId:n,clientName:i,clientEmail:c,clientPhone:o,onScheduled:d}=e,[x,m]=(0,a.useState)("both"),[u,h]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[f,b]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),v=()=>{let e=new Date;e.setHours(e.getHours()+1);let s=e.toISOString().split("T")[0],t=e.toTimeString().slice(0,5);h(s),g(t)};(0,a.useEffect)(()=>{s&&!u&&v()},[s]);let w=async()=>{if(!u||!p){N("Please select both date and time");return}if(("email"===x||"both"===x)&&!c){N("Email address is required for email delivery");return}if(("sms"===x||"both"===x)&&!o){N("Phone number is required for SMS delivery");return}b(!0),N(null);try{let e=new Date("".concat(u,"T").concat(p));if(e<=new Date){N("Scheduled time must be in the future"),b(!1);return}await (0,y.uI)(l,x,e,n)?(d(),t()):N("Failed to schedule follow-up. Please try again.")}catch(e){console.error("Error scheduling follow-up:",e),N("Failed to schedule follow-up. Please try again.")}finally{b(!1)}};return s?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Schedule Follow-up"}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-close-line text-xl"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-3",children:[(0,r.jsx)("h3",{className:"font-medium text-white mb-2",children:i}),(0,r.jsxs)("div",{className:"space-y-1 text-sm text-gray-400",children:[c&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line"})}),(0,r.jsx)("span",{children:c})]}),o&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-phone-line"})}),(0,r.jsx)("span",{children:o})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Delivery Method"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"radio",value:"email",checked:"email"===x,onChange:e=>m(e.target.value),disabled:!c,className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 focus:ring-blue-500"}),(0,r.jsxs)("span",{className:"text-sm ".concat(c?"text-gray-300":"text-gray-500"),children:["Email only ",!c&&"(no email provided)"]})]}),(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"radio",value:"sms",checked:"sms"===x,onChange:e=>m(e.target.value),disabled:!o,className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 focus:ring-blue-500"}),(0,r.jsxs)("span",{className:"text-sm ".concat(o?"text-gray-300":"text-gray-500"),children:["SMS only ",!o&&"(no phone provided)"]})]}),(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"radio",value:"both",checked:"both"===x,onChange:e=>m(e.target.value),disabled:!c||!o,className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 focus:ring-blue-500"}),(0,r.jsxs)("span",{className:"text-sm ".concat(c&&o?"text-gray-300":"text-gray-500"),children:["Both Email & SMS ",(!c||!o)&&"(requires both)"]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Send Date"}),(0,r.jsx)("input",{type:"date",value:u,onChange:e=>h(e.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-700 rounded-lg bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Send Time"}),(0,r.jsx)("input",{type:"time",value:p,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-700 rounded-lg bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quick Schedule"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Date;e.setMinutes(e.getMinutes()+30),h(e.toISOString().split("T")[0]),g(e.toTimeString().slice(0,5))},className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"+30 min"}),(0,r.jsx)("button",{onClick:()=>{let e=new Date;e.setHours(e.getHours()+1),h(e.toISOString().split("T")[0]),g(e.toTimeString().slice(0,5))},className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"+1 hour"}),(0,r.jsx)("button",{onClick:()=>{let e=new Date;e.setDate(e.getDate()+1),e.setHours(9,0,0,0),h(e.toISOString().split("T")[0]),g("09:00")},className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"Tomorrow 9AM"})]})]}),j&&(0,r.jsx)("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-300 text-sm",children:j})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 pt-4",children:[(0,r.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:"Cancel"}),(0,r.jsx)("button",{onClick:w,disabled:f||!u||!p,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:opacity-50 text-white rounded-lg transition-colors cursor-pointer whitespace-nowrap flex items-center justify-center space-x-2",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,r.jsx)("span",{children:"Scheduling..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-calendar-check-line"})}),(0,r.jsx)("span",{children:"Schedule"})]})})]})]})]})}):null}function b(e){let{audioUrl:s,label:t="Play Audio",variant:l="default",onPlay:n,onPause:i,onEnded:c}=e,[o,d]=(0,a.useState)(!1),[x,m]=(0,a.useState)(0),[u,h]=(0,a.useState)(0),[p,g]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),b=(0,a.useRef)(null),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=b.current;if(!e)return;let s=()=>{m(e.duration),g(!1)},t=()=>{h(e.currentTime)},r=()=>{d(!1),h(0),null==c||c()},a=()=>{f("Failed to load audio"),g(!1),d(!1)},l=()=>{g(!0),f(null)},n=()=>{g(!1)};return e.addEventListener("loadedmetadata",s),e.addEventListener("timeupdate",t),e.addEventListener("ended",r),e.addEventListener("error",a),e.addEventListener("loadstart",l),e.addEventListener("canplay",n),()=>{e.removeEventListener("loadedmetadata",s),e.removeEventListener("timeupdate",t),e.removeEventListener("ended",r),e.removeEventListener("error",a),e.removeEventListener("loadstart",l),e.removeEventListener("canplay",n)}},[s,c]);let N=async()=>{let e=b.current;if(e&&!p)try{o?(e.pause(),d(!1),null==i||i()):(await e.play(),d(!0),null==n||n())}catch(e){console.error("Error playing audio:",e),f("Playback failed"),d(!1)}},v=e=>{let s=b.current,t=j.current;if(!s||!t||!x)return;let r=t.getBoundingClientRect(),a=(e.clientX-r.left)/r.width*x;s.currentTime=a,h(a)},w=e=>"".concat(Math.floor(e/60),":").concat(Math.floor(e%60).toString().padStart(2,"0")),S=x>0?u/x*100:0;return"compact"===l?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("audio",{ref:b,src:s,preload:"metadata"}),(0,r.jsxs)("button",{onClick:N,disabled:p||!!y,className:"flex items-center space-x-1 px-2 py-1 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:[p?(0,r.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border border-white border-t-transparent"}):y?(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-error-warning-line"})}):(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat(o?"pause":"play","-fill")})}),(0,r.jsx)("span",{children:t})]}),y&&(0,r.jsx)("span",{className:"text-red-400 text-xs",children:y})]}):"inline"===l?(0,r.jsxs)("div",{className:"flex items-center space-x-3 bg-gray-900 rounded-lg p-2",children:[(0,r.jsx)("audio",{ref:b,src:s,preload:"metadata"}),(0,r.jsx)("button",{onClick:N,disabled:p||!!y,className:"w-8 h-8 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 rounded-full flex items-center justify-center transition-colors cursor-pointer whitespace-nowrap",children:p?(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border border-white border-t-transparent"}):y?(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-error-warning-line text-white"})}):(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat(o?"pause":"play","-fill text-white")})})}),(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("div",{ref:j,onClick:v,className:"flex-1 h-2 bg-gray-700 rounded-full cursor-pointer relative",children:(0,r.jsx)("div",{className:"h-full bg-purple-500 rounded-full transition-all duration-100",style:{width:"".concat(S,"%")}})}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 min-w-[60px] text-right",children:[w(u)," / ",w(x)]})]}),y&&(0,r.jsx)("span",{className:"text-red-400 text-xs",children:y})]}):(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[(0,r.jsx)("audio",{ref:b,src:s,preload:"metadata"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:N,disabled:p||!!y,className:"w-12 h-12 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 rounded-full flex items-center justify-center transition-colors cursor-pointer whitespace-nowrap",children:p?(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-white border-t-transparent"}):y?(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-error-warning-line text-white text-xl"})}):(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat(o?"pause":"play","-fill text-white text-xl")})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-white font-medium text-sm",children:t}),(0,r.jsxs)("span",{className:"text-gray-400 text-xs",children:[w(u)," / ",w(x)]})]}),(0,r.jsx)("div",{ref:j,onClick:v,className:"w-full h-2 bg-gray-700 rounded-full cursor-pointer relative",children:(0,r.jsx)("div",{className:"h-full bg-purple-500 rounded-full transition-all duration-100",style:{width:"".concat(S,"%")}})})]})]}),y&&(0,r.jsx)("div",{className:"mt-3 text-red-400 text-sm",children:y})]})}let j={friendly:{label:"Friendly",description:"Warm, conversational, and approachable tone",icon:"ri-emotion-happy-line",color:"bg-green-600"},professional:{label:"Professional",description:"Business-focused, formal, and comprehensive tone",icon:"ri-briefcase-line",color:"bg-blue-600"},direct:{label:"Direct",description:"Straight-forward, concise, and action-focused tone",icon:"ri-arrow-right-line",color:"bg-purple-600"},"action-oriented":{label:"Action-Oriented",description:"Urgency-driven with clear calls-to-action",icon:"ri-alarm-line",color:"bg-red-600"}};function N(e){let{data:s,loading:t,clientEmail:n,clientPhone:i,recordingId:c,onToneChange:d,scheduledFollowUp:x,userId:m,clientName:u,voiceSummaryUrl:h}=e,p={preferences:s.preferences||"No preferences found.",objections:s.objections||"No objections found.",sms:s.sms||"No SMS content available",email:s.email||"No email content available",urgencyLevel:s.urgencyLevel||"medium",keyTopics:s.keyTopics||["No topics found."],recommendedActions:s.recommendedActions||["No recommended actions."],tone:s.tone||"professional"};console.log("\uD83E\uDDE0 Final AI Follow-up data:",p);let[g,y]=(0,a.useState)("summary"),[N,v]=(0,a.useState)(null),[w,S]=(0,a.useState)(p.tone),[C,T]=(0,a.useState)({}),[E,k]=(0,a.useState)({preferences:p.preferences,objections:p.objections,sms:p.sms,email:p.email}),[D,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[F,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{k({preferences:p.preferences,objections:p.objections,sms:p.sms,email:p.email})},[p]);let O=async(e,s)=>{try{await navigator.clipboard.writeText(e),v(s),setTimeout(()=>v(null),2e3)}catch(e){console.error("Failed to copy:",e)}},U=e=>{S(e),d&&d(e)},L=e=>{T({...C,[e]:!0})},M=async e=>{if(!c){T({...C,[e]:!1}),I(!0);return}R(!0);try{let s=(0,l.JU)(o.db,"recordings",c),t={editedByAgent:!0,updatedAt:(0,l.Bt)()};t["aiFollowUpFinal.".concat(e)]=E[e],t["aiFollowUpFinal.tone"]=w,await (0,l.r7)(s,t),T({...C,[e]:!1}),I(!0),console.log("✅ Updated ".concat(e," in Firestore"))}catch(s){console.error("❌ Failed to update ".concat(e,":"),s),alert("Failed to save changes. Please try again.")}finally{R(!1)}},B=e=>{k({...E,[e]:"preferences"===e?p.preferences:"objections"===e?p.objections:"sms"===e?p.sms:p.email}),T({...C,[e]:!1})};return t?(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Generating AI Follow-up..."})]}),(0,r.jsx)("p",{className:"text-gray-400",children:"Analyzing conversation and creating personalized follow-up content"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-robot-line text-blue-500"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"AI Follow-up"}),A&&(0,r.jsx)("span",{className:"px-2 py-1 bg-orange-900/30 text-orange-300 rounded-full text-xs",children:"Edited"}),x?(0,r.jsxs)("div",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({pending:"text-yellow-400 bg-yellow-900/30",sent:"text-green-400 bg-green-900/30",failed:"text-red-400 bg-red-900/30",cancelled:"text-gray-400 bg-gray-900/30"}[x.status]),children:["pending"===x.status&&"⏰ Scheduled","sent"===x.status&&"✅ Delivered","failed"===x.status&&"❌ Failed","cancelled"===x.status&&"\uD83D\uDEAB Cancelled"]}):null]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[h&&(0,r.jsx)(b,{audioUrl:h,label:"\uD83D\uDD0A Voice Summary",variant:"compact"}),c&&m&&!x&&(0,r.jsxs)("button",{onClick:()=>P(!0),className:"flex items-center space-x-1 px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-calendar-schedule-line"})}),(0,r.jsx)("span",{children:"Schedule"})]})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsxs)("div",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"high":return"text-red-400 bg-red-900/30";case"medium":return"text-yellow-400 bg-yellow-900/30";case"low":return"text-green-400 bg-green-900/30";default:return"text-gray-400 bg-gray-900/30"}})(p.urgencyLevel)),children:[p.urgencyLevel.toUpperCase()," Priority"]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center space-x-2 mb-2",children:(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Follow-up Tone:"})}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(j).map(e=>{let[s,t]=e;return(0,r.jsxs)("button",{onClick:()=>U(s),className:"p-3 rounded-lg border text-left transition-colors cursor-pointer ".concat(w===s?"".concat(t.color," text-white border-transparent"):"bg-gray-900 text-gray-300 border-gray-700 hover:border-gray-600"),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:t.icon})}),(0,r.jsx)("span",{className:"font-medium text-sm",children:t.label})]}),(0,r.jsx)("p",{className:"text-xs opacity-75",children:t.description})]},s)})})]}),x&&(0,r.jsx)("div",{className:"mt-3 p-3 bg-blue-900/20 border border-blue-700/50 rounded-lg",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-blue-300 text-sm font-medium",children:["\uD83D\uDCC5 Scheduled for ",x.method," delivery"]}),(0,r.jsx)("p",{className:"text-blue-200 text-xs",children:new Date(x.sendAt.toDate()).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})})})]}),(0,r.jsxs)("div",{className:"flex border-b border-gray-700",children:[(0,r.jsx)("button",{onClick:()=>y("summary"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("summary"===g?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Summary"}),(0,r.jsx)("button",{onClick:()=>y("sms"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("sms"===g?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"SMS"}),(0,r.jsx)("button",{onClick:()=>y("email"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("email"===g?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Email"}),(0,r.jsx)("button",{onClick:()=>y("actions"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("actions"===g?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Actions"})]}),(0,r.jsxs)("div",{className:"p-4",children:["summary"===g&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h4",{className:"font-medium text-green-400",children:"Client Preferences"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[!C.preferences&&(0,r.jsx)("button",{onClick:()=>L("preferences"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-edit-line"})})}),(0,r.jsx)("button",{onClick:()=>O(E.preferences,"preferences"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("preferences"===N?"check":"file-copy","-line")})})})]})]}),C.preferences?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:E.preferences,onChange:e=>k({...E,preferences:e.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-gray-300 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>M("preferences"),disabled:D,className:"px-3 py-1 bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:D?"Saving...":"Save"}),(0,r.jsx)("button",{onClick:()=>B("preferences"),className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"Cancel"})]})]}):(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:E.preferences})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h4",{className:"font-medium text-red-400",children:"Client Concerns"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[!C.objections&&(0,r.jsx)("button",{onClick:()=>L("objections"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-edit-line"})})}),(0,r.jsx)("button",{onClick:()=>O(E.objections,"objections"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("objections"===N?"check":"file-copy","-line")})})})]})]}),C.objections?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:E.objections,onChange:e=>k({...E,objections:e.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-gray-300 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>M("objections"),disabled:D,className:"px-3 py-1 bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:D?"Saving...":"Save"}),(0,r.jsx)("button",{onClick:()=>B("objections"),className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"Cancel"})]})]}):(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:E.objections})]})]}),"sms"===g&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-message-3-line text-blue-500"})}),(0,r.jsx)("span",{className:"font-medium text-white",children:"SMS Message"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[!C.sms&&(0,r.jsx)("button",{onClick:()=>L("sms"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-edit-line"})})}),(0,r.jsx)("button",{onClick:()=>O(E.sms,"sms"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("sms"===N?"check":"file-copy","-line")})})})]})]}),i&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3 text-sm text-gray-400",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-phone-line"})}),(0,r.jsxs)("span",{children:["To: ",i]})]}),C.sms?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:E.sms,onChange:e=>k({...E,sms:e.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-gray-300 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,maxLength:160}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[E.sms.length,"/160 characters"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>M("sms"),disabled:D,className:"px-3 py-1 bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:D?"Saving...":"Save"}),(0,r.jsx)("button",{onClick:()=>B("sms"),className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"Cancel"})]})]})]}):(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-3",children:[(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:E.sms}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:[E.sms.length,"/160 characters"]})]})]}),"email"===g&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line text-blue-500"})}),(0,r.jsx)("span",{className:"font-medium text-white",children:"Email Message"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[!C.email&&(0,r.jsx)("button",{onClick:()=>L("email"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-edit-line"})})}),(0,r.jsx)("button",{onClick:()=>O(E.email,"email"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("email"===N?"check":"file-copy","-line")})})})]})]}),n&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3 text-sm text-gray-400",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line"})}),(0,r.jsxs)("span",{children:["To: ",n]})]}),C.email?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:E.email,onChange:e=>k({...E,email:e.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-gray-300 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:8}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>M("email"),disabled:D,className:"px-3 py-1 bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:D?"Saving...":"Save"}),(0,r.jsx)("button",{onClick:()=>B("email"),className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs transition-colors cursor-pointer whitespace-nowrap",children:"Cancel"})]})]}):(0,r.jsx)("div",{className:"bg-gray-900 rounded-lg p-3 max-h-64 overflow-y-auto",children:(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed whitespace-pre-line",children:E.email})})]}),"actions"===g&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-blue-400 mb-2",children:"Discussion Topics"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:p.keyTopics.map((e,s)=>(0,r.jsx)("span",{className:"px-3 py-1 bg-blue-900/30 text-blue-300 rounded-full text-sm",children:e},s))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-green-400 mb-2",children:"Recommended Next Steps"}),(0,r.jsx)("div",{className:"space-y-2",children:p.recommendedActions.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-900 rounded-lg",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center mt-0.5",children:(0,r.jsx)("i",{className:"ri-checkbox-circle-line text-green-500"})}),(0,r.jsx)("span",{className:"text-gray-300 text-sm",children:e})]},s))})]})]})]})]}),F&&c&&m&&u&&(0,r.jsx)(f,{isOpen:F,onClose:()=>P(!1),recordingId:c,userId:m,clientName:u,clientEmail:n,clientPhone:i,onScheduled:()=>{P(!1),window.location.reload()}})]})}let v=async(e,s)=>{console.log("\uD83C\uDF99️ TRANSCRIPTION: Starting AssemblyAI transcription for audio URL:",e);let t="6bc50afa1cec484aa2947874b1871dda";if(!t)return console.error("\uD83D\uDEA8 TRANSCRIPTION ERROR: AssemblyAI API key not found in environment variables"),null;try{let r=await fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({audio_url:e,language_code:"en_us",punctuate:!0,format_text:!0,speaker_labels:!0,auto_chapters:!1,summarization:!1})});if(!r.ok)throw Error("AssemblyAI submission failed: ".concat(r.status," ").concat(r.statusText));let a=await r.json();console.log("\uD83D\uDCE4 TRANSCRIPTION: Submitted to AssemblyAI, transcript ID:",a.id);let l=a.id,n=0;for(;n<100;){await new Promise(e=>setTimeout(e,3e3)),n++,console.log("\uD83D\uDD04 TRANSCRIPTION: Polling attempt ".concat(n,"/").concat(100," for transcript ").concat(l));let e=await fetch("https://api.assemblyai.com/v2/transcript/".concat(l),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("AssemblyAI status check failed: ".concat(e.status," ").concat(e.statusText));let r=await e.json();if(console.log("\uD83D\uDCCA TRANSCRIPTION STATUS:",r.status),"completed"===r.status){console.log("✅ TRANSCRIPTION: Completed successfully");let e=r.text||"";return s&&e&&(await w(s,e,"transcribed"),console.log("\uD83D\uDCBE FIRESTORE: Updated recording document with transcript")),e}if("error"===r.status)return console.error("\uD83D\uDEA8 TRANSCRIPTION ERROR:",r.error),s&&await w(s,null,"transcription-failed"),null}return console.error("⏰ TRANSCRIPTION ERROR: Polling timeout reached after",300,"seconds"),s&&await w(s,null,"transcription-failed"),null}catch(e){if(console.error("\uD83D\uDEA8 TRANSCRIPTION ERROR:",e),s)try{await w(s,null,"transcription-failed")}catch(e){console.error("\uD83D\uDEA8 FIRESTORE UPDATE ERROR:",e)}return null}},w=async(e,s,t)=>{try{let r=(0,l.JU)(o.db,"recordings",e),a={status:t,transcribedAt:(0,l.Bt)(),updatedAt:(0,l.Bt)()};s&&(a.transcript=s),await (0,l.r7)(r,a),console.log("\uD83D\uDCBE FIRESTORE: Updated recording ".concat(e," with status: ").concat(t))}catch(e){throw console.error("\uD83D\uDEA8 FIRESTORE UPDATE ERROR:",e),e}};var S=t(62),C=t(9360);function T(){let[e,s]=(0,a.useState)(null),[t,x]=(0,a.useState)(""),[m,h]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[T,E]=(0,a.useState)("form"),[k,D]=(0,a.useState)(!1),[R,A]=(0,a.useState)(!0),[I,F]=(0,a.useState)([]),[P,O]=(0,a.useState)(null),[U,L]=(0,a.useState)(null),[M,B]=(0,a.useState)(!1),{user:z}=(0,d.a)();(0,a.useEffect)(()=>{!M&&z&&I.length>0?(D(!1),B(!0)):!M&&z&&0===I.length&&B(!0)},[z,I,M]),(0,a.useEffect)(()=>{if(console.log("=== RECORDINGS QUERY DEBUG ==="),console.log("User state:",{user:z,uid:null==z?void 0:z.uid,isAuthenticated:!!z}),!z||!z.uid){console.log("User not authenticated yet, skipping recordings query"),F([]),A(!0);return}console.log("Starting recordings query for user:",z.uid);let e=(0,l.IO)((0,l.hJ)(o.db,"recordings"),(0,l.ar)("uid","==",z.uid),(0,l.Xo)("createdAt","desc"));return(0,l.cf)(e,e=>{console.log("Found ".concat(e.docs.length," recordings for user:"),z.uid),F(e.docs.map(e=>({id:e.id,...e.data()}))),A(!1)},e=>{console.error("❌ RECORDINGS QUERY ERROR:",e),A(!1)})},[z]);let q=async(t,r)=>{if(!e){console.error("❌ NO CURRENT SESSION: Cannot save recording without session data");return}if(!(null==z?void 0:z.uid)){console.error("❌ NO USER UID: Cannot save recording without authenticated user");return}console.log("=== RECORDING PROCESSING START ==="),console.log("Current session data:",e),console.log("User UID:",z.uid),b(!0),E("results");try{console.log("\uD83D\uDCE4 UPLOAD: Starting audio upload to Firebase Storage...");let a="recording-".concat(Date.now(),"-").concat((0,C.Z)(),".wav"),n=new File([t],a,{type:"audio/wav"}),i=(0,S.iH)(o.tO,"recordings/".concat(z.uid,"/").concat(a)),c=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;for(let s=1;s<=e;s++)try{console.log("\uD83D\uDCE4 Upload attempt ".concat(s,"/").concat(e));let t=(0,S.KV)(i,n),r=new Promise((e,s)=>setTimeout(()=>s(Error("Upload timeout after 30 seconds")),3e4));await Promise.race([t,r]);let a=await (0,S.Jt)(i);return console.log("✅ UPLOAD: Audio uploaded successfully:",a),a}catch(t){if(console.error("❌ Upload attempt ".concat(s," failed:"),t),s===e)throw Error("Firebase Storage upload failed. Please check your internet connection and try again.");await new Promise(e=>setTimeout(e,1e3*s))}throw Error("Upload failed after all retries")},d=await c(),m={uid:z.uid,audioPath:d,clientName:e.clientName,clientEmail:e.clientEmail,clientPhone:e.clientPhone,tags:e.tags,propertyId:e.propertyId,propertyAddress:e.propertyAddress,status:"uploaded",createdAt:(0,l.Bt)()};console.log("\uD83D\uDD25 FIRESTORE: Saving recording document with data:",m);let u=await (0,l.ET)((0,l.hJ)(o.db,"recordings"),m);console.log("✅ FIRESTORE: Recording document created with ID:",u.id,"status: uploaded"),console.log("\uD83C\uDFAF TRANSCRIPTION: Starting audio transcription...");try{let t=await v(d);console.log("✅ TRANSCRIPTION: Transcript generated successfully"),x(null!=t?t:""),await (0,l.r7)(u,{transcript:null!=t?t:"",status:"transcribed",updatedAt:(0,l.Bt)()}),console.log("✅ FIRESTORE: Recording updated with transcript, status: transcribed");let a={...e,transcript:null!=t?t:"",recordingDuration:r};if(s(a),console.log("\uD83E\uDD16 AI: Starting AI follow-up generation via Cloud Function..."),w(!0),t)try{let s=await (0,y.cu)(t,e.clientName);h(s),await (0,l.r7)(u,{summary:s.preferences,smsText:s.sms,emailText:s.email,status:"follow-up-ready",updatedAt:(0,l.Bt)()}),console.log("✅ AI: Follow-up content generated and saved, status: follow-up-ready")}catch(r){console.error("❌ AI GENERATION ERROR:",r);let s={preferences:"Unable to generate preferences summary. Please try again later.",objections:"Unable to generate objections summary. Please try again later.",sms:"Hi ".concat(e.clientName,"! Thanks for visiting the property today. Let me know if you have any questions!"),email:"Hi ".concat(e.clientName,",\n\nThank you for taking the time to view the property today. I hope you found it interesting.\n\nPlease let me know if you have any questions or would like to schedule another viewing.\n\nBest regards,\n[Your Name]"),urgencyLevel:"medium",keyTopics:["Property viewing","Client discussion"],recommendedActions:["Schedule follow-up call","Send property information"],tone:"professional"};h(s);let t="Unknown error";r instanceof Error&&(t=r.message),await (0,l.r7)(u,{summary:"AI generation failed - please try again later",smsText:s.sms,emailText:s.email,status:"follow-up-ready",errorMessage:t,updatedAt:(0,l.Bt)()})}w(!1)}catch(s){console.error("❌ TRANSCRIPTION ERROR:",s);let e="Transcription failed.";s instanceof Error&&(e="Transcription failed: "+s.message),await (0,l.r7)(u,{status:"transcription-failed",errorMessage:e,updatedAt:(0,l.Bt)()}),x("Transcription service is currently unavailable. Please try again later."),w(!1)}b(!1)}catch(s){console.error("❌ RECORDING PROCESSING ERROR:",s);let e="Recording upload failed. Please try again.";s instanceof Error&&(s.message.includes("Emulator")?e="Firebase Emulator connection failed. Please start the Firebase emulators and try again.":s.message.includes("timeout")&&(e="Upload timeout. Please check your internet connection and try again.")),alert(e),b(!1),w(!1),E("recording")}},_=()=>{D(!0),s(null),x(""),h(null),E("form"),O(null)},G=e=>e.toDate().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),H=e=>{if(!e)return"No transcript available";let s=e.split(". ");return s.slice(0,2).join(". ")+(s.length>2?"...":"")},Z=async(e,s)=>{try{await navigator.clipboard.writeText(e),L(s),setTimeout(()=>L(null),2e3)}catch(e){console.error("Failed to copy:",e)}},J=e=>{let{status:s}=e,t=(()=>{switch(s){case"uploaded":return{color:"text-yellow-400",icon:"ri-upload-line",text:"Uploaded"};case"transcribed":return{color:"text-blue-400",icon:"ri-file-text-line",text:"Transcribed"};case"follow-up-ready":return{color:"text-green-400",icon:"ri-check-line",text:"Follow-up Ready"};default:return{color:"text-gray-400",icon:"ri-time-line",text:"Processing"}}})();return(0,r.jsxs)("div",{className:"flex items-center space-x-1 ".concat(t.color),children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"".concat(t.icon," text-xs")})}),(0,r.jsx)("span",{className:"text-xs",children:t.text})]})};return P?(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[(0,r.jsx)(i.Z,{}),(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>O(null),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-left-line text-xl"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:P.clientName}),(0,r.jsx)("p",{className:"text-gray-400",children:G(P.createdAt)})]})]}),(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:(0,r.jsxs)("div",{className:"space-y-3",children:[P.propertyAddress&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-home-line text-blue-500"})}),(0,r.jsx)("span",{className:"text-gray-300 text-sm",children:P.propertyAddress})]}),P.tags&&P.tags.length>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-price-tag-line text-blue-500"})}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:P.tags.map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs",children:e},s))})]}),(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)(J,{status:P.status})})]})}),P.transcript&&(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-file-text-line text-blue-500"})}),(0,r.jsx)("h3",{className:"font-medium text-white",children:"Transcript"})]}),(0,r.jsx)("div",{className:"bg-gray-900 rounded-lg p-3 max-h-48 overflow-y-auto",children:(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:P.transcript})})]}),(P.smsText||P.emailText)&&(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 p-4 border-b border-gray-700",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-robot-line text-blue-500"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"AI Follow-up"})]}),(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[P.smsText&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-message-3-line text-green-500"})}),(0,r.jsx)("span",{className:"font-medium text-white",children:"SMS"})]}),(0,r.jsxs)("button",{onClick:()=>Z(P.smsText,"sms"),className:"flex items-center space-x-1 px-3 py-1 bg-green-600 hover:bg-green-700 rounded-lg text-white text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("sms"===U?"check":"file-copy","-line")})}),(0,r.jsx)("span",{children:"sms"===U?"Copied":"Copy SMS"})]})]}),P.clientPhone&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2 text-sm text-gray-400",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-phone-line"})}),(0,r.jsxs)("span",{children:["To: ",P.clientPhone]})]}),(0,r.jsx)("div",{className:"bg-gray-900 rounded-lg p-3",children:(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:P.smsText})})]}),P.emailText&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line text-blue-500"})}),(0,r.jsx)("span",{className:"font-medium text-white",children:"Email"})]}),(0,r.jsxs)("button",{onClick:()=>Z(P.emailText,"email"),className:"flex items-center space-x-1 px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded-lg text-white text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-".concat("email"===U?"check":"file-copy","-line")})}),(0,r.jsx)("span",{children:"email"===U?"Copied":"Copy Email"})]})]}),P.clientEmail&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2 text-sm text-gray-400",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line"})}),(0,r.jsxs)("span",{children:["To: ",P.clientEmail]})]}),(0,r.jsx)("div",{className:"bg-gray-900 rounded-lg p-3 max-h-64 overflow-y-auto",children:(0,r.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed whitespace-pre-line",children:P.emailText})})]})]})]})]}),(0,r.jsx)(c.Z,{})]})}):k?(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[(0,r.jsx)(i.Z,{}),(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6 space-y-6",children:["form"===T&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{D(!1),s(null),x(""),h(null),E("form"),O(null)},className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-left-line text-xl"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"New Recording Session"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Enter client details to begin"})]})]}),(0,r.jsx)(u,{onSubmit:e=>{console.log("=== CLIENT FORM SUBMITTED ==="),console.log("\uD83C\uDFE0 LINK TO PROPERTY ID:",{propertyId:e.propertyId,propertyAddress:e.propertyAddress}),s({...e,transcript:"",recordingDuration:0}),E("recording")}})]}),"recording"===T&&e&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>E("form"),className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-left-line text-xl"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:e.clientName}),(0,r.jsx)("p",{className:"text-gray-400",children:e.propertyAddress}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-500 mt-2",children:[e.clientEmail&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line"})}),(0,r.jsx)("span",{children:e.clientEmail})]}),e.clientPhone&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-phone-line"})}),(0,r.jsx)("span",{children:e.clientPhone})]})]}),e.tags&&e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs",children:e},s))})]})]}),(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-8 text-center border border-gray-700",children:(0,r.jsx)(p,{onRecordingComplete:q})})]}),"results"===T&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:null==e?void 0:e.clientName}),(0,r.jsx)("p",{className:"text-gray-400",children:null==e?void 0:e.propertyAddress})]}),t&&(0,r.jsx)(g,{transcript:t,loading:f}),m&&(0,r.jsx)(N,{data:m,loading:j,clientEmail:null==e?void 0:e.clientEmail,clientPhone:null==e?void 0:e.clientPhone}),(0,r.jsx)("button",{onClick:_,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:"Start New Session"})]})]}),(0,r.jsx)(c.Z,{})]})}):(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[(0,r.jsx)(i.Z,{}),(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Record"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Start a new recording or view past sessions"})]}),(0,r.jsxs)("button",{onClick:_,className:"w-full py-4 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors cursor-pointer whitespace-nowrap mb-8 flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mic-line"})}),(0,r.jsx)("span",{children:"Start Recording"})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"Recording History"})}),R?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mb-3"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Loading your recordings..."})]}):z?0===I.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mic-off-line text-4xl text-gray-600"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No recordings yet"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Start your first recording session above"})]}):(0,r.jsx)("div",{className:"space-y-4",children:I.map(e=>(0,r.jsxs)("div",{onClick:()=>O(e),className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 transition-colors cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-medium text-white",children:e.clientName}),(0,r.jsx)(J,{status:e.status})]}),e.propertyAddress&&(0,r.jsx)("p",{className:"text-sm text-gray-400 mb-2 truncate",children:e.propertyAddress}),e.tags&&e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mb-3",children:e.tags.map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs",children:e},s))}),e.transcript&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Transcript Preview:"}),(0,r.jsx)("p",{className:"text-sm text-gray-300 italic leading-relaxed",children:H(e.transcript)})]}),(e.smsText||e.emailText)&&(0,r.jsxs)("div",{className:"mb-3 space-y-2",children:[e.smsText&&(0,r.jsxs)("div",{className:"bg-gray-900 rounded p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-message-3-line text-green-500"})}),(0,r.jsx)("span",{className:"text-xs text-green-400 font-medium",children:"SMS"})]}),(0,r.jsx)("button",{onClick:s=>{s.stopPropagation(),Z(e.smsText,"sms-".concat(e.id))},className:"text-xs text-gray-400 hover:text-green-400 transition-colors cursor-pointer",children:U==="sms-".concat(e.id)?"Copied":"Copy"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-300 line-clamp-2",children:e.smsText.length>80?"".concat(e.smsText.substring(0,80),"..."):e.smsText})]}),e.emailText&&(0,r.jsxs)("div",{className:"bg-gray-900 rounded p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mail-line text-blue-500"})}),(0,r.jsx)("span",{className:"text-xs text-blue-400 font-medium",children:"Email"})]}),(0,r.jsx)("button",{onClick:s=>{s.stopPropagation(),Z(e.emailText,"email-".concat(e.id))},className:"text-xs text-gray-400 hover:text-blue-400 transition-colors cursor-pointer",children:U==="email-".concat(e.id)?"Copied":"Copy"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-300 line-clamp-2",children:e.emailText.length>80?"".concat(e.emailText.substring(0,80),"..."):e.emailText})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500",children:G(e.createdAt)}),(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-right-s-line text-gray-500"})})]})]},e.id))}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-user-line text-4xl text-gray-600"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Please sign in"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Sign in to view your recording history"})]})]}),(0,r.jsx)(c.Z,{})]})})}},9360:function(e,s,t){"use strict";t.d(s,{Z:function(){return c}});for(var r,a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},l=new Uint8Array(16),n=[],i=0;i<256;++i)n.push((i+256).toString(16).slice(1));var c=function(e,s,t){if(a.randomUUID&&!s&&!e)return a.randomUUID();var i=(e=e||{}).random||(e.rng||function(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(l)})();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,s){t=t||0;for(var c=0;c<16;++c)s[t+c]=i[c];return s}return function(e,s=0){return(n[e[s+0]]+n[e[s+1]]+n[e[s+2]]+n[e[s+3]]+"-"+n[e[s+4]]+n[e[s+5]]+"-"+n[e[s+6]]+n[e[s+7]]+"-"+n[e[s+8]]+n[e[s+9]]+"-"+n[e[s+10]]+n[e[s+11]]+n[e[s+12]]+n[e[s+13]]+n[e[s+14]]+n[e[s+15]]).toLowerCase()}(i)}}},function(e){e.O(0,[358,139,826,833,432,971,117,744],function(){return e(e.s=3129)}),_N_E=e.O()}]);