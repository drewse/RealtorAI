(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[664],{4016:function(e,t,s){Promise.resolve().then(s.bind(s,3562))},3562:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var r=s(7437),a=s(2265),l=s(5978),i=s(7293),o=s(4236),n=s(813),c=s(7763),d=s(1344),u=s(62),m=s(1210);let x=["Single Family","Condo","Townhouse","Multi-Family","Other"],p=["Active","Coming Soon","Sold"],h=["Ensuite","Large Backyard","Fireplace","In-unit Laundry","Walk-in Closet","Balcony/Patio","Hardwood Floors","Stainless Steel Appliances","Central Air","Swimming Pool","Home Office","Updated Kitchen","Master Suite","Fenced Yard"];function g(e){var t,s,l,n,c,d;let{onSubmit:g,onCancel:y,loading:b,isEditing:f=!1,initialData:j}=e,[N,v]=(0,a.useState)({address:(null==j?void 0:j.address)||"",addressLine1:(null==j?void 0:j.addressLine1)||"",city:(null==j?void 0:j.city)||"",state:(null==j?void 0:j.state)||"",postalCode:(null==j?void 0:j.postalCode)||"",price:(null==j?void 0:null===(t=j.price)||void 0===t?void 0:t.toString())||"",bedrooms:(null==j?void 0:null===(s=j.bedrooms)||void 0===s?void 0:s.toString())||"3",bathrooms:(null==j?void 0:null===(l=j.bathrooms)||void 0===l?void 0:l.toString())||"2",sqft:(null==j?void 0:null===(n=j.sqft)||void 0===n?void 0:n.toString())||"",description:(null==j?void 0:j.description)||"",propertyType:(null==j?void 0:j.propertyType)||"Single Family",lotSize:(null==j?void 0:null===(c=j.lotSize)||void 0===c?void 0:c.toString())||"",yearBuilt:(null==j?void 0:null===(d=j.yearBuilt)||void 0===d?void 0:d.toString())||"",parking:(null==j?void 0:j.parking)||"",mlsNumber:(null==j?void 0:j.mlsNumber)||"",status:(null==j?void 0:j.status)||"Active"}),[w,S]=(0,a.useState)(()=>(null==j?void 0:j.propertyFeatures)?j.propertyFeatures.filter(e=>h.includes(e)):[]),[C,E]=(0,a.useState)(()=>(null==j?void 0:j.propertyFeatures)?j.propertyFeatures.filter(e=>!h.includes(e)):[]),[k,P]=(0,a.useState)([]),[T,F]=(0,a.useState)((null==j?void 0:j.images)||[]),[D,I]=(0,a.useState)(!1),{user:A}=(0,o.a)(),R=async e=>{e.preventDefault(),console.log("=== ENHANCED PROPERTY FORM SUBMISSION DEBUG ==="),console.log("Raw form data:",N),console.log("Selected features:",w),console.log("Image files:",k.length);let t=N.addressLine1.trim().length>0,s=N.city.trim().length>0,r=N.state.trim().length>0,a=N.postalCode.trim().length>0,l=N.price&&!isNaN(parseInt(N.price)),o=N.sqft&&!isNaN(parseInt(N.sqft)),n=N.propertyType.length>0,c=N.status.length>0;if(console.log("Enhanced form validation:",{addressLine1:{value:N.addressLine1,isValid:t},city:{value:N.city,isValid:s},state:{value:N.state,isValid:r},postalCode:{value:N.postalCode,isValid:a},price:{value:N.price,isValid:l},sqft:{value:N.sqft,isValid:o},propertyType:{value:N.propertyType,isValid:n},status:{value:N.status,isValid:c},bedrooms:{value:N.bedrooms,parsed:parseInt(N.bedrooms)},bathrooms:{value:N.bathrooms,parsed:parseFloat(N.bathrooms)}}),!t||!s||!r||!a||!l||!o||!n||!c){alert("Please fill in all required fields with valid values.");return}I(!0);let d=[];try{if(k.length>0&&(null==A?void 0:A.uid)){console.log("\uD83D\uDDBC️ Uploading",k.length,"images to Firebase Storage");let e=k.map(async(e,t)=>{let s="property-".concat(Date.now(),"-").concat(t,".").concat(e.name.split(".").pop()),r=(0,u.iH)(i.tO,"properties/".concat(A.uid,"/").concat(s));await (0,u.KV)(r,e);let a=await (0,u.Jt)(r);return console.log("✅ Image uploaded:",s),a});d=await Promise.all(e),console.log("✅ All images uploaded successfully")}let e={address:"".concat(N.addressLine1.trim(),", ").concat(N.city.trim(),", ").concat(N.state.trim()," ").concat(N.postalCode.trim()),addressLine1:N.addressLine1.trim(),city:N.city.trim(),state:N.state.trim().toUpperCase(),postalCode:N.postalCode.trim(),price:parseInt(N.price),bedrooms:parseInt(N.bedrooms),bathrooms:parseFloat(N.bathrooms),sqft:parseInt(N.sqft),description:N.description.trim(),propertyType:N.propertyType,lotSize:N.lotSize?parseInt(N.lotSize):void 0,yearBuilt:N.yearBuilt?parseInt(N.yearBuilt):void 0,parking:N.parking.trim()||void 0,propertyFeatures:[...w,...C],mlsNumber:N.mlsNumber.trim()||void 0,status:N.status,images:f?[...T,...d]:d};console.log("Enhanced processed data being sent to onSubmit:",e),console.log("=== END ENHANCED FORM DEBUG ==="),g(e)}catch(e){console.error("❌ Error uploading images:",e),alert("Failed to upload images. Please try again.")}finally{I(!1)}},q=e=>{v({...N,[e.target.name]:e.target.value})},U=e=>{S(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},B=e=>{P(t=>t.filter((t,s)=>s!==e)),F(t=>t.filter((t,s)=>s!==e))},L=new Date().getFullYear();return(0,r.jsxs)("form",{id:"property-form",onSubmit:R,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white border-b border-gray-700 pb-2",children:"Basic Information"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"addressLine1",className:"block text-sm font-medium text-gray-300 mb-2",children:"Street Address *"}),(0,r.jsx)("input",{type:"text",id:"addressLine1",name:"addressLine1",value:N.addressLine1,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"123 Main Street",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"city",className:"text-sm font-medium text-gray-300 mb-2",children:"City *"}),(0,r.jsx)("input",{type:"text",id:"city",name:"city",value:N.city,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Windsor",required:!0})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"state",className:"text-sm font-medium text-gray-300 mb-2",children:"State / Province *"}),(0,r.jsx)("input",{type:"text",id:"state",name:"state",value:N.state,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"ON",required:!0})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"postalCode",className:"text-sm font-medium text-gray-300 mb-2",children:"Postal Code *"}),(0,r.jsx)("input",{type:"text",id:"postalCode",name:"postalCode",value:N.postalCode,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"N9B 3P4",required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"propertyType",className:"block text-sm font-medium text-gray-300 mb-2",children:"Property Type *"}),(0,r.jsx)("select",{id:"propertyType",name:"propertyType",value:N.propertyType,onChange:q,className:"w-full px-4 py-3 pr-8 border border-gray-700 rounded-lg bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0,children:x.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-300 mb-2",children:"Status *"}),(0,r.jsx)("select",{id:"status",name:"status",value:N.status,onChange:q,className:"w-full px-4 py-3 pr-8 border border-gray-700 rounded-lg bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0,children:p.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-300 mb-2",children:"Price *"}),(0,r.jsx)("input",{type:"number",id:"price",name:"price",value:N.price,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"450000",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"sqft",className:"block text-sm font-medium text-gray-300 mb-2",children:"Square Feet *"}),(0,r.jsx)("input",{type:"number",id:"sqft",name:"sqft",value:N.sqft,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"2500",required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"bedrooms",className:"block text-sm font-medium text-gray-300 mb-2",children:"Bedrooms *"}),(0,r.jsx)("select",{id:"bedrooms",name:"bedrooms",value:N.bedrooms,onChange:q,className:"w-full px-4 py-3 pr-8 border border-gray-700 rounded-lg bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[1,2,3,4,5,6].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"bathrooms",className:"block text-sm font-medium text-gray-300 mb-2",children:"Bathrooms *"}),(0,r.jsx)("select",{id:"bathrooms",name:"bathrooms",value:N.bathrooms,onChange:q,className:"w-full px-4 py-3 pr-8 border border-gray-700 rounded-lg bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[1,1.5,2,2.5,3,3.5,4,4.5,5].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white border-b border-gray-700 pb-2",children:"Additional Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"lotSize",className:"block text-sm font-medium text-gray-300 mb-2",children:"Lot Size (sq ft)"}),(0,r.jsx)("input",{type:"number",id:"lotSize",name:"lotSize",value:N.lotSize,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"7500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"yearBuilt",className:"block text-sm font-medium text-gray-300 mb-2",children:"Year Built"}),(0,r.jsx)("input",{type:"number",id:"yearBuilt",name:"yearBuilt",value:N.yearBuilt,onChange:q,min:"1800",max:L,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:L.toString()})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"parking",className:"block text-sm font-medium text-gray-300 mb-2",children:"Parking"}),(0,r.jsx)("input",{type:"text",id:"parking",name:"parking",value:N.parking,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"2-car garage, Street parking"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"mlsNumber",className:"block text-sm font-medium text-gray-300 mb-2",children:"MLS Number"}),(0,r.jsx)("input",{type:"text",id:"mlsNumber",name:"mlsNumber",value:N.mlsNumber,onChange:q,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"MLS123456"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white border-b border-gray-700 pb-2",children:"Property Features"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Common Features"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:h.map(e=>(0,r.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-gray-300 cursor-pointer hover:text-white transition-colors",children:[(0,r.jsx)("input",{type:"checkbox",checked:w.includes(e),onChange:()=>U(e),className:"w-4 h-4 bg-gray-800 border-gray-600 rounded focus:ring-blue-500 focus:ring-2"}),(0,r.jsx)("span",{children:e})]},e))})]}),(0,r.jsx)("div",{children:(0,r.jsx)(m.Z,{value:C,onChange:E,placeholder:"Type custom features like: Zen Garden, Soundproof Walls, Smart Home System...",label:"Custom Features"})}),[...w,...C].length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"All Features"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:[...w,...C].map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(w.includes(e)?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"),children:e},t))})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white border-b border-gray-700 pb-2",children:"Images"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-300 mb-2",children:"Property Images (Max 10, 5MB each)"}),(0,r.jsx)("input",{type:"file",id:"images",multiple:!0,accept:"image/*",onChange:e=>{let t=Array.from(e.target.files||[]);if(0===t.length)return;if(k.length+t.length>10){alert("Maximum 10 images allowed");return}let s=t.filter(e=>{let t=e.type.startsWith("image/"),s=e.size<=5242880;return t?!!s||(alert("".concat(e.name," is too large. Maximum size is 5MB")),!1):(alert("".concat(e.name," is not a valid image file")),!1)});0!==s.length&&(P(e=>[...e,...s]),s.forEach(e=>{let t=new FileReader;t.onload=e=>{F(t=>{var s;return[...t,null===(s=e.target)||void 0===s?void 0:s.result]})},t.readAsDataURL(e)}))},className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-600 file:text-white file:cursor-pointer hover:file:bg-blue-700 text-sm"})]}),T.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-3 gap-2",children:T.map((e,t)=>(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("img",{src:e,alt:"Preview ".concat(t+1),className:"w-full h-20 object-cover rounded-lg"}),(0,r.jsx)("button",{type:"button",onClick:()=>B(t),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-600 hover:bg-red-700 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-close-line"})})})]},t))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),(0,r.jsx)("textarea",{id:"description",name:"description",value:N.description,onChange:q,rows:3,maxLength:500,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-900 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm resize-none",placeholder:"Optional property description..."}),(0,r.jsxs)("div",{className:"text-right text-xs text-gray-500 mt-1",children:[N.description.length,"/500"]})]})]})}function y(e){let{statusHistory:t,priceHistory:s,loading:l}=e,[i,o]=(0,a.useState)("all"),n=e=>{switch(e){case"Active":return"text-green-400 bg-green-900/30";case"Coming Soon":return"text-yellow-400 bg-yellow-900/30";case"Sold":return"text-red-400 bg-red-900/30";default:return"text-gray-400 bg-gray-900/30"}},c=(e,t)=>{if(!e)return"ri-add-circle-line";let s={"Coming Soon":0,Active:1,Sold:2},r=s[e]||0,a=s[t]||0;return a>r?"ri-arrow-up-circle-line":a<r?"ri-arrow-down-circle-line":"ri-refresh-line"},d=e=>e?(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown date",u=e=>"$".concat(e.toLocaleString()),m=(e,t)=>void 0===e||void 0===t?"ri-price-tag-3-line":t>e?"ri-arrow-up-line":t<e?"ri-arrow-down-line":"ri-subtract-line",x=(e,t)=>void 0===e||void 0===t?"text-blue-400 bg-blue-900/30":t>e?"text-green-400 bg-green-900/30":t<e?"text-red-400 bg-red-900/30":"text-gray-400 bg-gray-900/30",p=()=>[...t.map(e=>({...e,type:"status",timestamp:e.changedAt})),...s.map(e=>({...e,type:"price",timestamp:e.changedAt}))].sort((e,t)=>{var s,r;let a=(null===(s=e.timestamp)||void 0===s?void 0:s.toDate)?e.timestamp.toDate():new Date(e.timestamp);return((null===(r=t.timestamp)||void 0===r?void 0:r.toDate)?t.timestamp.toDate():new Date(t.timestamp)).getTime()-a.getTime()});if(l)return(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Loading History..."})]})});let h=(()=>{let e=p();return"status"===i?e.filter(e=>"status"===e.type):"price"===i?e.filter(e=>"price"===e.type):e})();return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-history-line text-blue-500"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Property History"})]}),(0,r.jsxs)("div",{className:"flex space-x-1 bg-gray-900 rounded-lg p-1",children:[(0,r.jsx)("button",{onClick:()=>o("all"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("all"===i?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"All Changes"}),(0,r.jsx)("button",{onClick:()=>o("status"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("status"===i?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Status"}),(0,r.jsx)("button",{onClick:()=>o("price"),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full ".concat("price"===i?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:"Price"})]})]}),(0,r.jsx)("div",{className:"p-4",children:0===h.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-history-line text-4xl text-gray-600"})}),(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"No History Available"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Property changes will appear here"})]}):(0,r.jsx)("div",{className:"space-y-4",children:h.map((e,t)=>(0,r.jsxs)("div",{className:"relative",children:[t<h.length-1&&(0,r.jsx)("div",{className:"absolute left-6 top-12 w-0.5 h-12 bg-gray-700"}),(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center ".concat("status"===e.type?n(e.toStatus).replace("text-","bg-").replace("bg-","bg-opacity-20 text-"):x(e.fromPrice,e.toPrice).replace("text-","bg-").replace("bg-","bg-opacity-20 text-")),children:(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"status"===e.type?c(e.fromStatus,e.toStatus):m(e.fromPrice,e.toPrice)})})}),(0,r.jsxs)("div",{className:"flex-1 bg-gray-900 rounded-lg p-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsx)("div",{className:"flex items-center space-x-2",children:"status"===e.type?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Status Changed"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[e.fromStatus&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(n(e.fromStatus)),children:e.fromStatus}),(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-right-line text-gray-500"})})]}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(n(e.toStatus)),children:e.toStatus})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Price Changed"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[e.fromPrice&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-gray-300 text-sm",children:u(e.fromPrice)}),(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-right-line text-gray-500"})})]}),(0,r.jsx)("span",{className:"text-white font-medium",children:u(e.toPrice)})]})]})})}),(0,r.jsx)("div",{className:"text-xs text-gray-400 mb-2",children:d(e.timestamp)}),e.reason&&(0,r.jsxs)("div",{className:"text-sm text-gray-300 mb-1",children:[(0,r.jsx)("strong",{children:"Reason:"})," ",e.reason]}),e.notes&&(0,r.jsxs)("div",{className:"text-sm text-gray-300",children:[(0,r.jsx)("strong",{children:"Notes:"})," ",e.notes]})]})]})]},e.id))})})]})}function b(){let e="https://us-central1-showai-23713.cloudfunctions.net/importPropertyFromText";if(!e)throw Error("NEXT_PUBLIC_IMPORT_ENDPOINT is not set. Add it in Vercel (Production/Preview/Development) and redeploy.");return e}let f=new Map;async function j(e,t){let s="".concat(t,":").concat(e.trim().toLowerCase()),r=f.get(s);if(r)return console.info("Reusing active job creation",{key:s}),r;console.info("Creating import job...",{key:s,url:e,userId:t});let a=(async()=>{try{let s=b(),r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,userId:t})});if(console.info("Job creation response:",r.status),202===r.status){let e=await r.json();return console.info("Job created:",e.jobId),{jobId:e.jobId}}let a="HTTP ".concat(r.status);try{let e=await r.json();a=(null==e?void 0:e.error)||(null==e?void 0:e.message)||a}catch(e){try{a=await r.text()||a}catch(e){}}throw Error(a)}finally{f.delete(s)}})();return f.set(s,a),a}async function N(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{intervalMs:r=2e3,timeoutMs:a=12e4}=s;b();let l=Date.now();return console.info("Starting job polling...",{jobId:e,intervalMs:r,timeoutMs:a}),new Promise((s,i)=>{let o=async()=>{try{if(Date.now()-l>a){console.warn("Job polling timeout exceeded"),i(Error("Import job timed out. Please try again."));return}let n=function(){let e="https://us-central1-showai-23713.cloudfunctions.net/importJobStatus";if(!e)throw Error("NEXT_PUBLIC_IMPORT_STATUS_ENDPOINT is not set. Add it in Vercel (Production/Preview/Development) and redeploy.");return e}(),c=await fetch("".concat(n,"?id=").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok){let e="HTTP ".concat(c.status);try{let t=await c.json();e=(null==t?void 0:t.error)||(null==t?void 0:t.message)||e}catch(t){try{e=await c.text()||e}catch(e){}}throw Error(e)}let d=await c.json();if(console.info("Status tick:",d.status,{jobId:e}),t(d),"success"===d.status){console.info("Done: success",{jobId:e}),s({status:"success",result:d.result});return}if("error"===d.status){console.info("Done: error",{jobId:e,error:d.error}),s({status:"error",error:d.error,retryAfterSeconds:d.retryAfterSeconds});return}setTimeout(o,r)}catch(e){console.error("Job polling error:",e),i(e)}};o()})}async function v(e,t,s){let{jobId:r}=await j(e,t);return await N(r,s)}function w(e){let{isOpen:t,onClose:s,onImportSuccess:l}=e,[i,n]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[y,b]=(0,a.useState)("idle"),[f,j]=(0,a.useState)(null),[N,w]=(0,a.useState)(0),{user:S}=(0,o.a)();a.useEffect(()=>{if(N>0){let e=setTimeout(()=>{w(N-1)},1e3);return()=>clearTimeout(e)}f&&0===N&&j(null)},[N,f]);let C=async()=>{var e,t,r,a,o;if(!i.trim()){p("Please enter a listing link or description");return}if(!c){p("Please confirm you have permission to use this data");return}if(!(null==S?void 0:S.uid)){p("You must be logged in to import properties");return}if(!u){m(!0),p(""),g(!1),b("idle"),j(null);try{let r=await v(i.trim(),S.uid,e=>{"queued"===e.status?b("queued"):"working"===e.status&&b("working")});"success"===r.status?(g(!0),console.log("\uD83C\uDF89 Property import successful!"),l((null===(e=r.result)||void 0===e?void 0:e.data)||r.result),setTimeout(()=>{s(),n(""),d(!1),g(!1),b("idle")},1500)):"error"===r.status&&(r.retryAfterSeconds?(j(r.retryAfterSeconds),w(r.retryAfterSeconds),p("Rate limited. Try again in ".concat(r.retryAfterSeconds," seconds."))):(null===(t=r.error)||void 0===t?void 0:t.includes("UPSTREAM_TIMEOUT"))?p("Scraper took too long. Please try again."):p(r.error||"Import failed"))}catch(e){console.error("❌ Property import error:",e),(null===(r=e.message)||void 0===r?void 0:r.includes("TOO_MANY_ACTIVE_JOBS"))?p("Finish your current import before starting another."):(null===(a=e.message)||void 0===a?void 0:a.includes("429"))?p("Rate limited. Please try again later."):(null===(o=e.message)||void 0===o?void 0:o.includes("timeout"))?p("Import job timed out. Please try again."):p(e instanceof Error?e.message:"Failed to import property")}finally{m(!1),b("idle")}}},E=()=>{u||(s(),n(""),d(!1),p(""),g(!1),b("idle"),j(null),w(0))};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,r.jsxs)("div",{className:"w-full max-w-3xl h-[100svh] max-h-[100svh] flex flex-col bg-neutral-900 rounded-xl",children:[(0,r.jsxs)("header",{className:"sticky top-0 z-10 border-b bg-neutral-900 px-4 py-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",children:"AI Property Importer"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Import property details from listing URLs or descriptions"})]}),(0,r.jsx)("button",{onClick:E,disabled:u,className:"text-gray-400 hover:text-white transition-colors cursor-pointer disabled:opacity-50",children:(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-close-line text-xl"})})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-24 mobile-scroll scroll-contain",children:(0,r.jsxs)("div",{className:"space-y-4 py-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-300 mb-2",children:"Paste public listing link or description"}),(0,r.jsx)("textarea",{id:"content",value:i,onChange:e=>n(e.target.value),placeholder:"https://example.com/property-listing OR paste a property description...",rows:6,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm resize-none",disabled:u})]}),(0,r.jsx)("div",{className:"bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"permission",checked:c,onChange:e=>d(e.target.checked),disabled:u,className:"mt-1 w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500 focus:ring-2"}),(0,r.jsxs)("label",{htmlFor:"permission",className:"text-sm text-yellow-200",children:[(0,r.jsx)("span",{className:"font-medium",children:"✅ I confirm I have permission to use this data"}),(0,r.jsx)("p",{className:"text-xs text-yellow-300 mt-1",children:"Ensure you have the right to import and use this property information"})]})]})}),x&&(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-error-warning-line text-red-400"})}),(0,r.jsx)("p",{className:"text-red-300 text-sm",children:x})]})}),h&&(0,r.jsx)("div",{className:"bg-green-900/20 border border-green-700/50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-check-line text-green-400"})}),(0,r.jsx)("p",{className:"text-green-300 text-sm",children:"Property imported successfully! Opening form..."})]})})]})}),(0,r.jsx)("footer",{className:"sticky bottom-0 z-10 border-t bg-neutral-900 safe-bottom px-4 py-3",children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:E,disabled:u,className:"flex-1 px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white hover:bg-gray-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,r.jsx)("button",{onClick:C,disabled:u||!i.trim()||!c||null!==f,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:opacity-50 text-white font-medium rounded-lg transition-colors cursor-pointer flex items-center justify-center space-x-2 disabled:cursor-not-allowed",children:"queued"===y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-pulse rounded-full h-4 w-4 bg-white"}),(0,r.jsx)("span",{children:"Queued..."})]}):"working"===y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,r.jsx)("span",{children:"Importing..."})]}):u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,r.jsx)("span",{children:"Starting..."})]}):f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-timer-line"})}),(0,r.jsxs)("span",{children:["Try again in ",N,"s"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-download-line"})}),(0,r.jsx)("span",{children:"Import Property"})]})})]})})]})}):null}function S(e){let{message:t,type:s,onClose:l,duration:i=3e3}=e,[o,n]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=setTimeout(()=>{n(!1),setTimeout(l,300)},i);return()=>clearTimeout(e)},[i,l]);let c="success"===s?"text-green-300":"text-red-300";return(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 transition-all duration-300 ".concat(o?"opacity-100 translate-x-0":"opacity-0 translate-x-full"),children:(0,r.jsx)("div",{className:"".concat("success"===s?"bg-green-900/90":"bg-red-900/90"," border ").concat("success"===s?"border-green-700":"border-red-700"," rounded-lg p-4 max-w-sm shadow-lg"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center ".concat(c),children:(0,r.jsx)("i",{className:"".concat("success"===s?"ri-check-line":"ri-error-warning-line"," text-lg")})}),(0,r.jsx)("p",{className:"".concat(c," text-sm font-medium"),children:t}),(0,r.jsx)("button",{onClick:()=>{n(!1),setTimeout(l,300)},className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-close-line"})})})]})})})}var C=s(9360);function E(){let[e,t]=(0,a.useState)([]),[s,u]=(0,a.useState)([]),[m,x]=(0,a.useState)(!1),[p,h]=(0,a.useState)(null),[b,f]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!0),[v,E]=(0,a.useState)(""),[k,P]=(0,a.useState)(""),[T,F]=(0,a.useState)(!1),[D,I]=(0,a.useState)(""),[A,R]=(0,a.useState)("success"),[q,U]=(0,a.useState)(!1),[B,L]=(0,a.useState)(null),[O,z]=(0,a.useState)("Active"),[H,M]=(0,a.useState)(!1),{user:_}=(0,o.a)(),V=(e,t)=>{I(e),R(t),F(!0)};(0,a.useEffect)(()=>{H||!_||j||(z("Active"),M(!0))},[_,j,H]),(0,a.useEffect)(()=>{if(console.log("=== PROPERTIES QUERY DEBUG ==="),console.log("User state:",{user:_,uid:null==_?void 0:_.uid,isAuthenticated:!!_}),!_||!_.uid){console.log("User not authenticated yet, skipping properties query"),N(!0);return}console.log("Starting Firestore query for userId:",_.uid);let e=(0,l.IO)((0,l.hJ)(i.db,"properties"),(0,l.ar)("userId","==",_.uid),(0,l.Xo)("createdAt","desc"));return(0,l.cf)(e,e=>{console.log("Firestore snapshot received:",{size:e.size,empty:e.empty,docs:e.docs.length});let s=e.docs.map(e=>({id:e.id,...e.data()}));console.log("Processed properties data:",s),t(s),N(!1)},e=>{console.error("Firestore query error:",e),N(!1),E("Failed to load properties. Please try again.")})},[_]),(0,a.useEffect)(()=>{if(!_)return;let e=(0,l.IO)((0,l.hJ)(i.db,"recordings"),(0,l.ar)("uid","==",_.uid));return(0,l.cf)(e,e=>{u(e.docs.map(e=>({id:e.id,propertyId:e.data().propertyId})))})},[_]);let J=e.filter(e=>e.status===O),Y=e=>s.filter(t=>t.propertyId===e).length,Z=async e=>{console.log("=== ENHANCED FIRESTORE PROPERTY SAVE DEBUG ==="),console.log("1. Enhanced property data received:",e);try{var t,s,r,a;let o=i.I8.currentUser;if(console.log("2. Current user check:",{user:o,uid:null==o?void 0:o.uid,isLoggedIn:!!o}),!o||!o.uid){let e="You must be logged in to add a property.";console.error("3. AUTHENTICATION ERROR:",e),V(e,"error");return}let n={address:!!e.address&&e.address.trim().length>0,price:!!e.price&&!isNaN(e.price)&&e.price>0,bedrooms:!!e.bedrooms&&!isNaN(e.bedrooms),bathrooms:!!e.bathrooms&&!isNaN(e.bathrooms),sqft:!!e.sqft&&!isNaN(e.sqft)&&e.sqft>0,propertyType:!!e.propertyType&&e.propertyType.trim().length>0,status:!!e.status&&e.status.trim().length>0};if(console.log("3. Enhanced field validation results:",n),console.log("4. Enhanced detailed field values:",{address:{value:e.address,type:typeof e.address},price:{value:e.price,type:typeof e.price},bedrooms:{value:e.bedrooms,type:typeof e.bedrooms},bathrooms:{value:e.bathrooms,type:typeof e.bathrooms},sqft:{value:e.sqft,type:typeof e.sqft},propertyType:{value:e.propertyType,type:typeof e.propertyType},status:{value:e.status,type:typeof e.status},propertyFeatures:{value:e.propertyFeatures,length:e.propertyFeatures.length},images:{value:e.images,length:e.images.length}}),!Object.values(n).every(e=>!0===e)){let e="Please fill in all required fields with valid values.";console.error("5. VALIDATION ERROR:",e,n),E(e),alert(e);return}E(""),P("");let c=(0,l.Bt)(),d=new Date,u={address:e.address.trim(),addressLine1:(null===(t=e.addressLine1)||void 0===t?void 0:t.trim())||"",city:(null===(s=e.city)||void 0===s?void 0:s.trim())||"",state:(null===(r=e.state)||void 0===r?void 0:r.trim().toUpperCase())||"",postalCode:(null===(a=e.postalCode)||void 0===a?void 0:a.trim())||"",price:Number(e.price),bedrooms:Number(e.bedrooms),bathrooms:Number(e.bathrooms),sqft:Number(e.sqft),description:e.description?e.description.trim():"",propertyType:e.propertyType,lotSize:e.lotSize?Number(e.lotSize):null,yearBuilt:e.yearBuilt?Number(e.yearBuilt):null,parking:e.parking?e.parking.trim():null,propertyFeatures:e.propertyFeatures||[],mlsNumber:e.mlsNumber?e.mlsNumber.trim():null,status:e.status,images:e.images||[],userId:o.uid,clients:[],statusHistory:[{id:(0,C.Z)(),toStatus:e.status,changedBy:o.uid,changedAt:d,reason:"Property created",notes:"Initial property listing"}],priceHistory:[{id:(0,C.Z)(),toPrice:Number(e.price),changedBy:o.uid,changedAt:d,reason:"Initial listing price",notes:"Property created with initial price"}],createdAt:c};console.log("6. Final enhanced document to save:",u),console.log("7. Firestore collection reference:",(0,l.hJ)(i.db,"properties")),console.log("8. Attempting enhanced addDoc to Firestore...");let m=await (0,l.ET)((0,l.hJ)(i.db,"properties"),u);console.log("9. SUCCESS: Enhanced document saved with ID:",m.id),console.log("=== END ENHANCED FIRESTORE DEBUG ===");let p='Property "'.concat(e.address,'" added successfully!');V(p,"success"),x(!1)}catch(e){console.error("=== ENHANCED FIRESTORE ERROR DEBUG ==="),console.error("Error details:",e),console.error("Error message:",e instanceof Error?e.message:"Unknown error"),console.error("Error stack:",e instanceof Error?e.stack:"No stack trace"),console.error("=== END ENHANCED ERROR DEBUG ==="),V("Failed to add property: ".concat(e instanceof Error?e.message:"Unknown error"),"error")}},G=async e=>{try{await (0,l.oe)((0,l.JU)(i.db,"properties",e))}catch(e){console.error("Error deleting property:",e)}},W=async e=>{if(p&&(null==_?void 0:_.uid)){console.log("=== PROPERTY UPDATE DEBUG ==="),console.log("1. Property data received:",e),console.log("2. Selected property ID:",p.id);try{var t,s,r,a;let o={address:!!e.address&&e.address.trim().length>0,price:!!e.price&&!isNaN(e.price)&&e.price>0,bedrooms:!!e.bedrooms&&!isNaN(e.bedrooms),bathrooms:!!e.bathrooms&&!isNaN(e.bathrooms),sqft:!!e.sqft&&!isNaN(e.sqft)&&e.sqft>0,propertyType:!!e.propertyType&&e.propertyType.trim().length>0,status:!!e.status&&e.status.trim().length>0};if(console.log("3. Field validation results:",o),!o.address||!o.price||!o.sqft||!o.propertyType||!o.status){let e="Please fill in all required fields with valid values.";console.error("4. VALIDATION ERROR:",e),V(e,"error");return}let n=new Date().toISOString(),c=p.status!==e.status,d=p.price!==e.price,u={address:e.address.trim(),addressLine1:(null===(t=e.addressLine1)||void 0===t?void 0:t.trim())||"",city:(null===(s=e.city)||void 0===s?void 0:s.trim())||"",state:(null===(r=e.state)||void 0===r?void 0:r.trim().toUpperCase())||"",postalCode:(null===(a=e.postalCode)||void 0===a?void 0:a.trim())||"",price:Number(e.price),bedrooms:Number(e.bedrooms),bathrooms:Number(e.bathrooms),sqft:Number(e.sqft),description:e.description?e.description.trim():"",propertyType:e.propertyType,lotSize:e.lotSize?Number(e.lotSize):null,yearBuilt:e.yearBuilt?Number(e.yearBuilt):null,parking:e.parking?e.parking.trim():null,propertyFeatures:e.propertyFeatures||[],mlsNumber:e.mlsNumber?e.mlsNumber.trim():null,status:e.status,images:e.images||[],updatedAt:(0,l.Bt)()};if(c){let t={id:(0,C.Z)(),fromStatus:p.status,toStatus:e.status,changedBy:_.uid,changedAt:n,reason:"Property details updated",notes:"Status changed during property update"};u.statusHistory=(0,l.vr)(t)}if(d){let t={id:(0,C.Z)(),fromPrice:p.price,toPrice:Number(e.price),changedBy:_.uid,changedAt:n,reason:"Property details updated",notes:"Price changed during property update"};u.priceHistory=(0,l.vr)(t)}console.log("5. Final update data:",u),console.log("6. Updating property document...");let m=(0,l.JU)(i.db,"properties",p.id);await (0,l.r7)(m,u),console.log("7. SUCCESS: Property updated successfully"),console.log("=== END PROPERTY UPDATE DEBUG ===");let x='Property "'.concat(e.address,'" updated successfully!');V(x,"success"),f(!1),h(null)}catch(e){console.error("=== PROPERTY UPDATE ERROR DEBUG ==="),console.error("Error details:",e),console.error("Error message:",e instanceof Error?e.message:"Unknown error"),console.error("=== END PROPERTY UPDATE ERROR DEBUG ==="),V("Failed to update property: ".concat(e instanceof Error?e.message:"Unknown error"),"error")}}},K=t=>e.filter(e=>e.status===t).length;if(p){var X,$;let e=Y(p.id);return(0,r.jsxs)(n.Z,{children:[(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[(0,r.jsx)(c.Z,{}),(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{h(null),f(!1)},className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-left-line text-xl"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:"Property Details"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:p.address})]})]}),!b&&(0,r.jsxs)("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors cursor-pointer flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-edit-line"})}),(0,r.jsx)("span",{children:"Edit"})]})]}),b&&(0,r.jsx)(g,{onSubmit:W,onCancel:()=>f(!1),loading:!1,isEditing:!0,initialData:{address:p.address,price:p.price,bedrooms:p.bedrooms,bathrooms:p.bathrooms,sqft:p.sqft,description:p.description,propertyType:p.propertyType,lotSize:p.lotSize,yearBuilt:p.yearBuilt,parking:p.parking,propertyFeatures:p.propertyFeatures,mlsNumber:p.mlsNumber,status:p.status,images:p.images}}),!b&&p.images&&p.images.length>0&&(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg overflow-hidden border border-gray-700",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[p.images.slice(0,4).map((e,t)=>(0,r.jsx)("div",{className:"".concat(0===t&&1===p.images.length?"col-span-2":""," aspect-square"),children:(0,r.jsx)("img",{src:e,alt:"Property ".concat(t+1),className:"w-full h-full object-cover"})},t)),p.images.length>4&&(0,r.jsxs)("div",{className:"absolute bottom-2 right-2 bg-black/60 text-white px-2 py-1 rounded text-xs",children:["+",p.images.length-4," more"]})]})}),!b&&(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[p.addressLine1&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Street Address"}),(0,r.jsx)("span",{className:"text-white font-medium",children:p.addressLine1})]}),p.city&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"City"}),(0,r.jsx)("span",{className:"text-white",children:p.city})]}),p.state&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"State/Province"}),(0,r.jsx)("span",{className:"text-white",children:p.state})]}),p.postalCode&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Postal Code"}),(0,r.jsx)("span",{className:"text-white",children:p.postalCode})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Status"}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("Active"===p.status?"bg-green-900/30 text-green-300":"Coming Soon"===p.status?"bg-yellow-900/30 text-yellow-300":"bg-red-900/30 text-red-300"),children:p.status})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Property Type"}),(0,r.jsx)("span",{className:"text-white font-medium",children:p.propertyType})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Price"}),(0,r.jsxs)("span",{className:"text-white font-medium",children:["$",p.price.toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Bedrooms"}),(0,r.jsx)("span",{className:"text-white",children:p.bedrooms})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Bathrooms"}),(0,r.jsx)("span",{className:"text-white",children:p.bathrooms})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Square Feet"}),(0,r.jsx)("span",{className:"text-white",children:p.sqft.toLocaleString()})]}),p.lotSize&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Lot Size"}),(0,r.jsxs)("span",{className:"text-white",children:[p.lotSize.toLocaleString()," sq ft"]})]}),p.yearBuilt&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Year Built"}),(0,r.jsx)("span",{className:"text-white",children:p.yearBuilt})]}),p.parking&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Parking"}),(0,r.jsx)("span",{className:"text-white",children:p.parking})]}),p.mlsNumber&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"MLS Number"}),(0,r.jsx)("span",{className:"text-white",children:p.mlsNumber})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Linked Recordings"}),(0,r.jsx)("span",{className:"text-blue-400 font-medium",children:e})]})]}),p.propertyFeatures&&p.propertyFeatures.length>0&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[(0,r.jsx)("h4",{className:"text-gray-400 text-sm font-medium mb-2",children:"Features"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:p.propertyFeatures.map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs",children:e},t))})]}),p.description&&(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:(0,r.jsx)("p",{className:"text-gray-300 text-sm",children:p.description})})]}),!b&&(0,r.jsx)(y,{statusHistory:p.statusHistory||[],priceHistory:p.priceHistory||[],loading:!1}),!b&&(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-user-line text-blue-500"})}),(0,r.jsx)("h3",{className:"font-medium text-white",children:"Clients"})]}),(null===(X=p.clients)||void 0===X?void 0:X.length)===0?(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"No clients recorded for this property yet"}):(0,r.jsx)("div",{className:"space-y-3",children:null===($=p.clients)||void 0===$?void 0:$.map(e=>(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h4",{className:"text-white font-medium",children:e.name}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("interested"===e.status?"bg-green-900 text-green-300":"not_interested"===e.status?"bg-red-900 text-red-300":"bg-yellow-900 text-yellow-300"),children:e.status.replace("_"," ")})]}),(0,r.jsxs)("div",{className:"space-y-1 text-sm text-gray-400",children:[(0,r.jsx)("p",{children:e.email}),(0,r.jsx)("p",{children:e.phone}),e.showingDate&&(0,r.jsxs)("p",{children:["Showing: ",e.showingDate]})]})]},e.id))})]})]}),(0,r.jsx)(d.Z,{})]}),T&&(0,r.jsx)(S,{message:D,type:A,onClose:()=>F(!1)})]})}return(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[(0,r.jsx)(c.Z,{}),(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Properties"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Manage your property listings"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>U(!0),className:"px-3 py-2 bg-green-600 hover:bg-green-700 rounded-lg flex items-center space-x-2 transition-colors cursor-pointer text-sm font-medium",title:"Add by Link or Description",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-download-line text-white"})}),(0,r.jsx)("span",{className:"text-white",children:"Import"})]}),(0,r.jsx)("button",{onClick:()=>x(!0),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 rounded-full flex items-center justify-center transition-colors cursor-pointer whitespace-nowrap",title:"Add Property",children:(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-add-line text-white text-xl"})})})]})]}),(0,r.jsx)("div",{className:"flex bg-gray-800 rounded-lg p-1 mb-6",children:["Active","Coming Soon","Sold"].map(e=>{let t=K(e);return(0,r.jsxs)("button",{onClick:()=>z(e),className:"flex-1 px-1 py-1 text-sm font-medium transition-colors cursor-pointer whitespace-nowrap rounded-full flex items-center justify-center space-x-1 ".concat(O===e?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:[(0,r.jsx)("span",{children:e}),(0,r.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded-full ".concat(O===e?"bg-blue-700 text-blue-100":"bg-gray-700 text-gray-300"),children:t})]},e)})}),v&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-700 rounded-lg",children:[(0,r.jsx)("p",{className:"text-red-300 text-sm",children:v}),(0,r.jsx)("button",{onClick:()=>E(""),className:"text-red-400 hover:text-red-300 text-xs mt-1 cursor-pointer",children:"Dismiss"})]}),k&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-green-900/30 border border-green-700 rounded-lg",children:[(0,r.jsx)("p",{className:"text-green-300 text-sm",children:k}),(0,r.jsx)("button",{onClick:()=>P(""),className:"text-green-400 hover:text-green-300 text-xs mt-1 cursor-pointer",children:"Dismiss"})]}),m&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,r.jsxs)("div",{className:"w-full max-w-3xl h-[100svh] max-h-[100svh] flex flex-col bg-neutral-900 rounded-xl",children:[(0,r.jsxs)("header",{className:"sticky top-0 z-10 border-b bg-neutral-900 px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Add New Property"}),(0,r.jsx)("button",{onClick:()=>{x(!1),E(""),P("")},className:"text-gray-400 hover:text-white transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-close-line text-xl"})})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-24 mobile-scroll scroll-contain",children:(0,r.jsx)(g,{onSubmit:Z,onCancel:()=>{x(!1),E(""),P(""),L(null)},initialData:B})}),(0,r.jsx)("footer",{className:"sticky bottom-0 z-10 border-t bg-neutral-900 safe-bottom px-4 py-3",children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{x(!1),E(""),P(""),L(null)},className:"flex-1 px-4 py-3 border border-gray-700 rounded-lg bg-gray-700 text-white hover:bg-gray-600 transition-colors cursor-pointer",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",form:"property-form",className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors cursor-pointer",children:"Add Property"})]})})]})}),j?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mb-4"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Loading your properties..."})]}):_?0===J.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-home-line text-4xl text-gray-600"})}),(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:["No ",O.toLowerCase()," properties"]}),(0,r.jsx)("p",{className:"text-gray-500",children:0===e.length?"Add your first property to get started":"Switch to another tab or add your first ".concat(O.toLowerCase()," property")})]}):(0,r.jsx)("div",{className:"space-y-4",children:J.map(e=>{var t,s;let a=Y(e.id);return(0,r.jsxs)("div",{onClick:()=>h(e),className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 transition-colors cursor-pointer",children:[e.images&&e.images.length>0&&(0,r.jsxs)("div",{className:"mb-3 rounded-lg overflow-hidden",children:[(0,r.jsx)("img",{src:e.images[0],alt:"Property",className:"w-full h-32 object-cover"}),e.images.length>1&&(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-black/60 text-white px-2 py-1 rounded text-xs",children:["+",e.images.length-1]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("h3",{className:"font-medium text-white truncate",children:e.address}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("Active"===e.status?"bg-green-900/30 text-green-300":"Coming Soon"===e.status?"bg-yellow-900/30 text-yellow-300":"bg-red-900/30 text-red-300"),children:e.status})]}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),G(e.id)},className:"text-gray-400 hover:text-red-400 transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-delete-bin-line"})})})]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("p",{className:"text-blue-400 font-semibold text-lg",children:["$",e.price.toLocaleString()]}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:e.propertyType})]}),(0,r.jsx)("div",{className:"flex items-center justify-between text-sm text-gray-400 mb-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{children:[e.bedrooms," bed"]}),(0,r.jsxs)("span",{children:[e.bathrooms," bath"]}),(0,r.jsxs)("span",{children:[e.sqft.toLocaleString()," sqft"]})]})}),e.propertyFeatures&&e.propertyFeatures.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.propertyFeatures.slice(0,3).map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs",children:e},t)),e.propertyFeatures.length>3&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-700 text-gray-400 rounded-full text-xs",children:["+",e.propertyFeatures.length-3]})]}),a>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-mic-line text-blue-500"})}),(0,r.jsxs)("span",{className:"text-xs text-blue-400",children:[a," recording",1!==a?"s":""," linked"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[(null===(t=e.clients)||void 0===t?void 0:t.length)||0," client",1!==((null===(s=e.clients)||void 0===s?void 0:s.length)||0)?"s":""]}),(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-arrow-right-s-line text-gray-500"})})]})]},e.id)})}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-user-line text-4xl text-gray-600"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Authentication Required"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Please log in to view your properties"})]})]}),(0,r.jsx)(d.Z,{}),(0,r.jsx)(w,{isOpen:q,onClose:()=>U(!1),onImportSuccess:e=>{L(e),x(!0),V("Property data imported successfully! Please review and save.","success")}}),T&&(0,r.jsx)(S,{message:D,type:A,onClose:()=>F(!1)})]})})}},1210:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(7437),a=s(2265);function l(e){let{value:t,onChange:s,placeholder:l="Type tags separated by commas...",label:i="Tags",className:o="",disabled:n=!1}=e,[c,d]=(0,a.useState)("");(0,a.useEffect)(()=>{d("")},[t]);let u=()=>{if(!c.trim())return;let e=c.split(",").map(e=>e.trim()).filter(e=>e.length>0).filter(e=>!t.includes(e));e.length>0&&(s([...t,...e]),d(""))},m=e=>{s(t.filter(t=>t!==e))};return(0,r.jsxs)("div",{className:o,children:[i&&(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[i,(0,r.jsx)("span",{className:"text-gray-500 text-xs ml-2",children:"(comma-separated)"})]}),(0,r.jsx)("input",{type:"text",value:c,onChange:e=>{d(e.target.value)},onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),u())},onBlur:()=>{u()},placeholder:l,disabled:n,className:"w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm disabled:opacity-50 disabled:cursor-not-allowed"}),t.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:t.map((e,t)=>(0,r.jsxs)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-300 rounded-full text-xs flex items-center space-x-1 group",children:[(0,r.jsx)("span",{children:e}),!n&&(0,r.jsx)("button",{type:"button",onClick:()=>m(e),className:"text-blue-400 hover:text-blue-200 transition-colors cursor-pointer",children:(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,r.jsx)("i",{className:"ri-close-line text-xs"})})})]},t))})]})}},9360:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});for(var r,a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},l=new Uint8Array(16),i=[],o=0;o<256;++o)i.push((o+256).toString(16).slice(1));var n=function(e,t,s){if(a.randomUUID&&!t&&!e)return a.randomUUID();var o=(e=e||{}).random||(e.rng||function(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(l)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){s=s||0;for(var n=0;n<16;++n)t[s+n]=o[n];return t}return function(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}(o)}}},function(e){e.O(0,[358,139,826,833,971,117,744],function(){return e(e.s=4016)}),_N_E=e.O()}]);